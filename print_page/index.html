<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Print Site - ç°ä»£CMakeæ•™ç¨‹</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="../css/print-site-enum-headings1.css" rel="stylesheet">
        <link href="../css/print-site-enum-headings2.css" rel="stylesheet">
        <link href="../css/print-site-enum-headings3.css" rel="stylesheet">
        <link href="../css/print-site-enum-headings4.css" rel="stylesheet">
        <link href="../css/print-site-enum-headings5.css" rel="stylesheet">
        <link href="../css/print-site-enum-headings6.css" rel="stylesheet">
        <link href="../css/print-site.css" rel="stylesheet">
        <link href="../css/print-site-mkdocs.css" rel="stylesheet">
        <link href="../extra.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">ç°ä»£CMakeæ•™ç¨‹</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">ç« èŠ‚åˆ—è¡¨</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href=".." class="dropdown-item">ç°ä»£CMakeæ•™ç¨‹</a>
</li>
                                    
<li>
    <a href="../%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="dropdown-item">CMake C++ç¯å¢ƒæ­å»º</a>
</li>
                                    
<li>
    <a href="../%E7%8E%B0%E4%BB%A3CMake%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5/" class="dropdown-item">ç°ä»£CMakeçš„æ ¸å¿ƒæ¦‚å¿µ</a>
</li>
                                    
<li>
    <a href="../%E6%9C%80%E5%B0%8F%E6%9E%84%E5%BB%BA/" class="dropdown-item">æœ€å°çš„CMakeListsæ¡ˆä¾‹</a>
</li>
                                    
<li>
    <a href="../find_package%E6%A1%88%E4%BE%8B/" class="dropdown-item">find_packageæ¡ˆä¾‹</a>
</li>
                                    
<li>
    <a href="../CMakePresets/" class="dropdown-item">CMakePresets.json</a>
</li>
                                    
<li>
    <a href="../%E8%AE%BE%E7%BD%AE%E7%9B%AE%E6%A0%87%E5%B1%9E%E6%80%A7/" class="dropdown-item">è®¾ç½®ç›®æ ‡å±æ€§</a>
</li>
                                    
<li>
    <a href="../QtCMake/" class="dropdown-item">Qt + CMake (example/step6)</a>
</li>
                                    
<li>
    <a href="../%E5%9F%BA%E6%9C%AC%E5%B8%B8%E8%AF%86/" class="dropdown-item">åŸºæœ¬å¸¸è¯†</a>
</li>
                                    
<li>
    <a href="../%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5/" class="dropdown-item">å‚è€ƒæ–‡æ¡£</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">ç»å…¸æ¡ˆä¾‹</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../æ™®é€šCMakeé¡¹ç›®.md" class="dropdown-item">None</a>
</li>
                                    
<li>
    <a href="../QtCMakeé¡¹ç›®.md" class="dropdown-item">None</a>
</li>
                                    
<li>
    <a href="../CMake%E5%88%B6%E4%BD%9C%E5%BA%93/" class="dropdown-item">cmakeåˆ¶ä½œåº“</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../%E5%9F%BA%E6%9C%AC%E5%B8%B8%E8%AF%86/" class="nav-link">åŸºæœ¬å¸¸è¯†</a>
                            </li>
                            <li class="nav-item">
                                <a href="../about/" class="nav-link">å…³äº</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="0"><a href="#section-ç« èŠ‚åˆ—è¡¨" class="nav-link">I. ç« èŠ‚åˆ—è¡¨</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="1"><a href="#index" class="nav-link">1. ç°ä»£CMakeæ•™ç¨‹</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba" class="nav-link">2. CMake C++ç¯å¢ƒæ­å»º</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5" class="nav-link">3. ç°ä»£CMakeçš„æ ¸å¿ƒæ¦‚å¿µ</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba" class="nav-link">4. æœ€å°çš„CMakeListsæ¡ˆä¾‹</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#find_package%e6%a1%88%e4%be%8b" class="nav-link">5. find_packageæ¡ˆä¾‹</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#cmakepresets" class="nav-link">6. CMakePresets.json</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#%e8%ae%be%e7%bd%ae%e7%9b%ae%e6%a0%87%e5%b1%9e%e6%80%a7" class="nav-link">7. è®¾ç½®ç›®æ ‡å±æ€§</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#qtcmake" class="nav-link">8. Qt + CMake (example/step6)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86" class="nav-link">9. åŸºæœ¬å¸¸è¯†</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="1"><a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="nav-link">10. å‚è€ƒæ–‡æ¡£</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="0"><a href="#section-ç»å…¸æ¡ˆä¾‹" class="nav-link">II. ç»å…¸æ¡ˆä¾‹</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="1"><a href="#cmake%e5%88%b6%e4%bd%9c%e5%ba%93" class="nav-link">11. cmakeåˆ¶ä½œåº“</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="0"><a href="#%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86" class="nav-link">12. åŸºæœ¬å¸¸è¯†</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="0"><a href="#about" class="nav-link">13. å…³äº</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        
                        <h1 class='nav-section-title' id='section-ç« èŠ‚åˆ—è¡¨'>
                            ç« èŠ‚åˆ—è¡¨ <a class='headerlink' href='#section-ç« èŠ‚åˆ—è¡¨' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="index"><h1 id="index-cmake">ç°ä»£CMakeæ•™ç¨‹</h1>
<p>C++çš„å¤æ‚ç³»ç»Ÿæ„å»ºå‡ ä¹éƒ½è¦ç”¨åˆ°CMake,è™½ç„¶å›½å†…å·²æœ‰ä¸å°‘å…³äºCMakeçš„æ•™ç¨‹ï¼Œä½†æ˜¯å¾ˆå¤šç¼ºå°‘ä¸“ä¸šæ€§ï¼Œä¸å¤Ÿä¸¥è°¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç°ä»£çš„ã€å‡†ç¡®çš„CMakeæ•™ç¨‹ã€‚</p>
<blockquote>
<p>é¡¹ç›®ç›®å‰æ­£åœ¨å¼€å‘ä¸­<a href="https://github.com/CrossroadW/ModernCMake">githubä»“åº“</a></p>
</blockquote>
<p><img alt="cmake" src="../img/cmakerate.png" /></p>
<h2 id="index-cmake_1">ä»€ä¹ˆæ˜¯CMakeï¼Ÿ</h2>
<p><a href="https://cmake.org/">CMake</a> æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å¼€æº<a href="#index-buildsystem">æ„å»ºç³»ç»Ÿ</a>ç”Ÿæˆå™¨(ä¹Ÿç§°ä¸º<a href="https://en.wikipedia.org/wiki/List_of_build_automation_software">å…ƒæ„å»ºå·¥å…·</a>)ï¼Œå®ƒèƒ½å¤Ÿä¸ºå…¶ä»–æ„å»ºå·¥å…·ï¼ˆå¦‚ Visual Studioã€Makeã€Ninjaã€Xcodeï¼‰ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ project.slnã€build.ninjaã€Makefileï¼‰<br />
CMake çš„ç‰¹è‰²åŠŸèƒ½åŒ…æ‹¬ï¼š</p>
<blockquote>
<ul>
<li>è·¨å¹³å°æ”¯æŒï¼šå¯ä»¥åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œç¼–è¯‘å™¨ä¹‹é—´æ— ç¼åˆ‡æ¢ã€‚</li>
<li>Target-centric approach(ä»¥<a href="#ç°ä»£cmakeçš„æ ¸å¿ƒæ¦‚å¿µ-coreconcept">ç›®æ ‡</a>ä¸ºä¸­å¿ƒ)ï¼šèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹æ–‡ä»¶é—´çš„ä¾èµ–å…³ç³»ï¼Œå‡å°‘æ‰‹åŠ¨æ“ä½œã€‚</li>
<li>å¤šç§æ„å»ºç³»ç»Ÿæ”¯æŒï¼šæ”¯æŒç”Ÿæˆ Visual Studioã€Makeã€Ninja ç­‰å¤šç§æ„å»ºå·¥å…·çš„é…ç½®æ–‡ä»¶ã€‚</li>
<li>è·¨å¹³å°å®‰è£…ï¼šä½¿ç”¨ç›¸åŒçš„å‘½ä»¤é›†ï¼Œå¯ä»¥åœ¨ Linuxã€Windows å’Œ Mac ä¸Šå®‰è£…è½¯ä»¶åŒ…ã€‚</li>
<li>æ”¯æŒè°ƒè¯•CMakeä»£ç (Visual Studioã€VScode):<a href="https://microsoft.github.io/debug-adapter-protocol/implementors/tools/">ç¬¬ä¸‰æ–¹å·¥å…·</a></li>
</ul>
</blockquote>
<p>æœ¬è´¨ä¸Šï¼Œæ„å»ºç³»ç»Ÿçš„ä»»åŠ¡æ˜¯å°†æºä»£ç æ–‡ä»¶ï¼ˆå¦‚ .cppï¼‰è½¬æ¢ä¸ºå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¦‚ .exeã€.libã€.dllï¼‰ã€‚
<img alt="public/Single_Source_Build.png" src="../img/Single_Source_Build.png" /></p>
<h2 id="index-_1">ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ç¼–è¯‘å™¨ï¼Ÿ</h2>
<p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯ç›´æ¥é€šè¿‡å‘½ä»¤è¡Œè°ƒç”¨ç¼–è¯‘å™¨ï¼Œå¦‚ gccã€cl.exeã€clang++ ç­‰å·¥å…·ã€‚ä½†æ˜¯ï¼Œå½“ä»£ç åº“å˜å¾—å¤æ‚æ—¶ï¼Œä»…é å‘½ä»¤è¡Œä¸å¤Ÿç”¨äº†ã€‚</p>
<h4 id="index-_2">å•æ–‡ä»¶ç¼–è¯‘</h4>
<p>å¯¹äºå•ä¸ªæ–‡ä»¶çš„ç¼–è¯‘ï¼Œåªéœ€ä¸€æ¡å‘½ä»¤ï¼š</p>
<pre><code class="language-bash">g++ -o main.exe main.cpp
</code></pre>
<h4 id="index-_3">å¤šæ–‡ä»¶ç¼–è¯‘</h4>
<p>å½“æ¶‰åŠå¤šä¸ªæºæ–‡ä»¶æ—¶ï¼Œå‘½ä»¤è¡Œæ›´å¤æ‚ï¼š:</p>
<pre><code class="language-bash"># examples/step1
$ tree
â”œâ”€â”€ foo.cpp
â”œâ”€â”€ foo.h
â”œâ”€â”€ main.cpp
$ g++ -o foo.o -c foo.cpp
$ g++ -o main.o -c main.cpp 
$ g++ -o step1 main.o foo.o
$ ./step1 
43
</code></pre>
<p>æ­¤å¤–ï¼Œå¦‚æœéœ€è¦åŒæ—¶æ„å»º Debug å’Œ Release ç‰ˆæœ¬ï¼Œæˆ–è€…é“¾æ¥å¤–éƒ¨åº“ï¼Œå‘½ä»¤è¡Œçš„å¤æ‚åº¦å°†è¿…é€Ÿæå‡ï¼Œæ•ˆç‡ä¹Ÿä¼šå¤§å¤§é™ä½ã€‚</p>
<hr />
<h2 id="index-_4">æ¦‚å¿µè§£é‡Š</h2>
<p><a id="buildsystem"></a></p>
<h4 id="index-buildsystem"><a href="https://en.wikipedia.org/wiki/Software_build">æ„å»º</a>ä¸æ„å»ºç³»ç»Ÿ(buildsystem):</h4>
<blockquote>
<p>ç®€å•æ¥è¯´ï¼Œè½¯ä»¶å¼€å‘ä¸­çš„æ„å»ºæ˜¯å°†æºä»£ç æ–‡ä»¶â€œç¿»è¯‘â€ä¸ºå¯æ‰§è¡ŒäºŒè¿›åˆ¶ä»£ç æ–‡ä»¶çš„è¿‡ç¨‹ï¼›è€Œæ„å»ºç³»ç»Ÿæ˜¯ä¸€ç»„ç”¨äºè¾…åŠ©å’Œè‡ªåŠ¨åŒ–æ„å»ºè¿‡ç¨‹çš„è½¯ä»¶å·¥å…·é›†åˆã€‚<br />
ä»¥ä¸‹æ˜¯å¸¸è§çš„æ„å»ºç³»ç»Ÿ:  </p>
<blockquote>
<p><a href="https://ninja-build.org/manual.html">Ninja build system</a><br />
<a href="https://cmake.org/cmake/help/latest/manual/cmake-buildsystem.7.html#introduction">cmake-buildsystem</a><br />
<a href="https://bazel.build/about/intro?hl=zh-cn">bazel.build</a><br />
<a href="https://www.gnu.org/software/make/">Make</a>ã€<a href="https://maven.apache.org/what-is-maven.html">Maven</a> å’Œ <a href="https://gradle.org/">Gradle</a>  </p>
</blockquote>
</blockquote>
<p><a id="metabuildsystem"></a></p>
<h4 id="index-metabuildsystem">å…ƒæ„å»ºç³»ç»Ÿ(metabuildsystem):</h4>
<p>å…ƒæ„å»ºç³»ç»Ÿå³ä¸€ä¸ªç”Ÿæˆå…¶ä»–æ„å»ºç³»ç»Ÿçš„æ„å»ºç³»ç»Ÿã€‚å¦‚:<a href="https://gyp.gsrc.io/">GYP</a>(Generate Your Projects)</p>
<h4 id="index-cmake_2">CMakeä¸æ„å»ºç³»ç»Ÿå…³ç³»</h4>
<p>æ„å»ºç³»ç»Ÿï¼šå°†å¼€å‘è€…å†™çš„çš„<code>æºä»£ç </code>è½¬æ¢ä¸ºå¯ä¾›æœºå™¨è¯»å–çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚
ä¾‹å¦‚:æ„å»ºç³»ç»Ÿå¯ä»¥æ˜¯makeå’Œé¡¹ç›®çš„Makefile(ä¹Ÿå¯ä»¥æ˜¯IDEçš„é¡¹ç›®æ–‡ä»¶)ç»„åˆæˆçš„é¡¹ç›®æ–‡ä»¶ã€‚
CMakeé€šè¿‡generatorè¿™ä¸€<code>åç«¯</code>ç”Ÿæˆé€‚ç”¨äºæ¯ä¸ªæœºå™¨çš„æ„å»ºç³»ç»Ÿã€‚
ç”Ÿæˆæ„å»ºç³»ç»Ÿéœ€è¦ä¸‰ä¸ªè¦ç´ ï¼š
Source Tree(æºä»£ç ç›®å½•):åŒ…å«æºä»£ç çš„é¡¹ç›®é¡¶çº§ç›®å½•ï¼Œä»åä¸ºCMakeLists.txtæ–‡ä»¶å¼€å§‹ã€‚
Build Tree(æ„å»ºæ ‘ç›®å½•)ï¼šå­˜å‚¨æ„å»ºç³»ç»Ÿçš„é¡¶çº§ç›®å½•ï¼ŒCMakeä¼šç”Ÿæˆæœ‰CMakeCache.txtæ¥ä¸ºè¯¥ç›®å½•æ ‡è®°å¹¶å­˜å‚¨æ„å»ºä¿¡æ¯ã€‚(CMakeæ”¯æŒå°†Build Treeç½®äºSource Treeå†…(æºå†…æ„å»º)ï¼Œä½†ä¸é¼“åŠ±è¿™æ ·åš)
ç”Ÿæˆå™¨: è¿›è¡ŒCMakeé…ç½®æ—¶ä½¿ç”¨ -G é€‰é¡¹æ¥æŒ‡å®šç”Ÿæˆå™¨(æˆ–è€…ä¸å†™ï¼Œä¿æŒé»˜è®¤)</p>
<h2 id="index-_5">ä¸‹ä¸€ç« <a href="#%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba">ç¯å¢ƒæ­å»º</a></h2>
<h1 id="index-_6">èµåŠ©</h1>
<p>å¦‚æœä½ è§‰å¾—æœ¬é¡¹ç›®å¯¹ä½ çš„å¸®åŠ©å¾ˆå¤§ï¼Œå¯ä»¥è¯·ä½œè€…å–ä¸€æ¯å¥¶èŒ¶ğŸğŸ˜‰ã€‚
<img alt="å¾®ä¿¡" src="../img/wechat.jpg" />
<img alt="æ”¯ä»˜å®" src="../img/alipay.jpg" /></p></section><section class="print-page" id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba"><h1 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-cmake-c">CMake C++ç¯å¢ƒæ­å»º</h1>
<h2 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-c">C++ç¼–è¯‘å™¨å®‰è£…</h2>
<p>æœ¬æ•™ç¨‹ä¸»è¦è®²è§£Windowsä¸Šç¼–è¯‘å™¨çš„å®‰è£…ï¼Œä»…ä»‹ç»ä¸‹é¢ä¸‰ç§å®‰è£…æ–¹å¼ï¼š</p>
<h3 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-1-visual-studio">1. Visual Studio[æ¨è]ï¼š</h3>
<p>å®‰è£…Visual Studioå¹¶å‹¾é€‰Desktop development with C++<a href="https://learn.microsoft.com/zh-cn/cpp/build/vscpp-step-0-installation?view=msvc-170">VS install</a></p>
<h3 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-2-scoop">2. Scoop(å‘½ä»¤è¡Œå®‰è£…å·¥å…·):</h3>
<p>é¦–å…ˆåœ¨PowerShellæ‰§è¡Œ<a href="https://scoop.sh/">scoopå®˜ç½‘</a>çš„è„šæœ¬ï¼Œ
è¿›å…¥<a href="https://scoop.sh/#/apps?q=winlibs">winlibs</a>çš„æœç´¢ç»“æœé¡µé¢
éšæ„é€‰æ‹©ä¸€ä¸ªåŒ…ï¼Œå¹¶åœ¨PowerShellä¸­æ‰§è¡Œå¯¹åº”çš„å®‰è£…å‘½ä»¤ï¼Œä¾‹å¦‚ä¸‹é¢çš„å‘½ä»¤ï¼š
<img alt="winlibs" src="../img/scoopinstallwlibs.png" /></p>
<blockquote>
<p>æ‰§è¡Œè¿™é‡Œçš„å‘½ä»¤(scoop install main/mingw-winlibs)ä¼šè‡ªåŠ¨å°†ç¼–è¯‘å™¨çš„å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ç›®å½•æ·»åŠ è¿›ç¯å¢ƒå˜é‡ï¼Œä½¿å¾—PowerShellä¸­èƒ½å¤Ÿç›´æ¥ä½¿ç”¨g++ã€gccäº†ï¼Œä»¥åŠVScodeçš„æ’ä»¶å’ŒCMakeèƒ½å¤Ÿæ‰¾åˆ°å¯¹åº”è·¯å¾„ä¸‹çš„ç¼–è¯‘å™¨ã€‚</p>
</blockquote>
<h3 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-3-winlibs">3. æ‰‹åŠ¨å®‰è£…<a href="https://winlibs.com/">winlibs</a>ï¼š</h3>
<p>æ¨èä¸‹è½½å›¾ä¸­çš„å‹ç¼©åŒ…(ä¹Ÿå¯ä»¥ä¸‹è½½å³è¾¹çš„ä¸å¸¦LLVMçš„ç‰ˆæœ¬ï¼Œä½“ç§¯æ›´å°)ï¼Œè§£å‹åæŠŠg++.exeæ‰€åœ¨ç›®å½•åŠ å…¥ç¯å¢ƒå˜é‡æ—¢å¯
<img alt="winlibsdownload" src="../img/winlibsdownload.png" /></p>
<h2 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-cmake">CMakeç¯å¢ƒå‡†å¤‡å’Œæ’ä»¶é…ç½®</h2>
<p>å®é™…ä¸Šå¾ˆå¤šIDEä¸Šéƒ½CMakeæœ‰æ”¯æŒï¼Œå¸¸è§çš„å¦‚ï¼šVScodeã€Visual Studioã€Clionï¼Œ
å½“ç„¶å‘½ä»¤è¡Œæ˜¯æœ€é€šç”¨çš„æ–¹æ³•ï¼Œè¿™äº›éƒ½ä¸æ˜¯å¿…è¦çš„ï¼Œåªæ˜¯æœ‰é«˜äº®å’Œè¡¥å…¨ä¼šæ›´å‹å¥½ã€‚</p>
<ul>
<li>é¦–å…ˆéœ€è¦å®‰è£…CMake</li>
<li>å¯¹äºVScode éœ€è¦å®‰è£…ä¸‹é¢ä¸¤ä¸ªæ’ä»¶ï¼Œæ”¯æŒé«˜äº®å’Œéƒ¨åˆ†è¡¥å…¨ 
<img alt="img/cmakeplugin.png" src="../img/vscodecmake.png" /><blockquote>
<p>å®‰è£…CMakeæ’ä»¶åå¯èƒ½æ²¡æœ‰å®Œå…¨å±•ç¤ºçŠ¶æ€æ¡,éœ€è¦åœ¨.vscode/settings.jsonä¸­åŠ ä¸Š<br>
<code>"cmake.options.&gt; statusBarVisibility": "compact"</code></p>
</blockquote>
</li>
</ul>
<h2 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-cmake-tools">CMake Toolsæ’ä»¶çš„å…·ä½“åŠŸèƒ½</h2>
<p>å®‰è£…CMake ToolsåçŠ¶æ€æ ä¼šæœ‰æˆ‘ä»¬å¸¸ç”¨çš„å‡ ä¸ªåŠŸèƒ½ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹è¿™äº›åŠŸèƒ½å…·ä½“ä½œç”¨ã€‚</p>
<h3 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-_1">æ„å»ºç±»å‹</h3>
<p><img alt="buildtype" src="../img/buildtype.png" /><br />
å›¾ä¸­[Debug]æ˜¯æŒ‡æ„å»ºçš„æ—¶å€™ä¼šä½¿ç”¨Debugä½œä¸ºæ„å»ºç±»å‹,å¯ä»¥é€‰æ‹©çš„æœ‰Debugã€Releaseã€RelWithDebInfo å’Œ MinSizeRel
æ„å»ºç±»å‹ä¼šå½±å“ä¸‹é¢çš„å†…å®¹(å½±å“çš„å‘½ä»¤è¡Œå‚æ•°ä»¥GCCä¸ºä¾‹)ï¼š</p>
<ol>
<li>ä¼˜åŒ–çº§åˆ«: [-O1,-O2,-O3]</li>
<li>å¯æ‰§è¡Œæ–‡ä»¶æ˜¯å¦åŒ…å«<code>è°ƒè¯•ä¿¡æ¯</code>: [-g]</li>
<li>ä»£ç ä¸­assertæ˜¯å¦èµ·ä½œç”¨: [-DNDEBUG]  <blockquote>
<p>Debug: å¸¦æœ‰Debugä¿¡æ¯ï¼Œæ”¯æŒæ–­ç‚¹<br />
Releaseï¼šæ²¡æœ‰Debugä¿¡æ¯ï¼Œä¸æ”¯æŒæ–­ç‚¹ï¼Œå¯ç”¨ä»£ç ä¼˜åŒ–(æ€§èƒ½)ã€‚<br />
RelWithDebInfoï¼šå¯ç”¨ä»£ç ä¼˜åŒ–ï¼Œå¸¦æœ‰Debugä¿¡æ¯ï¼Œæ–­ç‚¹å¯èƒ½ä¸å‡†<br />
MinSizeRelï¼šå¯ç”¨ä»£ç ä½“ç§¯ä¼˜åŒ–  </p>
</blockquote>
</li>
</ol>
<h3 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-_2">ç¼–è¯‘å™¨å·¥å…·é“¾</h3>
<p><img alt="å·¥å…·é“¾" src="../img/vscodetoolkit.png" /><br />
å›¾ä¸­ <code>[GCC 14.2.1 x86_64]</code> æŒ‡ CMake æ„å»ºä½¿ç”¨çš„ç¼–è¯‘å™¨å·¥å…·é“¾ï¼Œå¯èƒ½çš„é€‰æ‹©åŒ…æ‹¬ï¼š    </p>
<blockquote>
<p><strong>MSVC (Microsoft Visual C++)</strong>: Windows å¹³å°ä¸‹çš„ä¸»æµç¼–è¯‘å™¨ï¼Œé€šå¸¸é€šè¿‡ Visual Studio æˆ– MSBuild å®‰è£…ã€‚<br />
<strong>MinGW/MinGW-w64</strong>: æä¾› GCC å·¥å…·é“¾çš„ Windows ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡å®‰è£… MinGW-w64ï¼ˆä¾‹å¦‚ <code>winlibs</code>ï¼‰ã€‚<br />
<strong>Clang</strong>: ä¸€ä¸ªè·¨å¹³å°çš„ç°ä»£ç¼–è¯‘å™¨ã€‚</p>
</blockquote>
<p><code>å·¥å…·é“¾</code>ä¸ä»…ä»…æ˜¯æŒ‡ç¼–è¯‘å™¨ï¼Œè¿˜åŒ…æ‹¬æ„å»ºå’Œé“¾æ¥è¿‡ç¨‹æ‰€éœ€çš„å…¶ä»–å·¥å…·å’Œé…ç½®ã€‚</p>
<details>
<summary>å·¥å…·é“¾</summary>

ç¼–è¯‘å™¨ï¼ˆCompilerï¼‰: ä¾‹å¦‚ g++ã€cl.exe æˆ– clang++ï¼Œç”¨äºå°† C++ æºä»£ç ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶ã€‚<br>
é“¾æ¥å™¨ï¼ˆLinkerï¼‰: ä¾‹å¦‚ ld æˆ– MSVC è‡ªå¸¦çš„é“¾æ¥å·¥å…·ï¼Œç”¨äºå°†ç›®æ ‡æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“ã€‚<br> 
å½’æ¡£å·¥å…·ï¼ˆArchiverï¼‰: ä¾‹å¦‚ arï¼Œç”¨äºç”Ÿæˆå’Œç®¡ç†é™æ€åº“ã€‚  <br>
è°ƒè¯•å™¨ï¼ˆDebuggerï¼‰: ä¾‹å¦‚ gdb æˆ– Visual Studio è°ƒè¯•å·¥å…·ï¼Œç”¨äºè°ƒè¯•ç¨‹åºè¿è¡Œã€‚ <br> 
æ„å»ºå·¥å…·ï¼ˆBuild Toolsï¼‰: ä¾‹å¦‚ make æˆ– ninjaï¼Œç”¨äºæ‰§è¡Œæ„å»ºè§„åˆ™ã€‚  <br>

</details>

<h3 id="%e7%8e%af%e5%a2%83%e6%90%ad%e5%bb%ba-_3">é€‰æ‹©æ„å»ºç›®æ ‡ã€è°ƒè¯•ã€è¿è¡Œ</h3>
<p><img alt="debugrun" src="../img/debugrun.png" /></p>
<ul>
<li>æœ€å·¦çš„æ˜¯é€‰æ‹©æ„å»ºç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯é€‰æ‹©ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶(.exe)ï¼Œæˆ–è€…æ„å»ºçš„å…¶ä»–ç±»å‹çš„ç›®æ ‡  </li>
<li>ä¸­é—´çš„æ˜¯debugæ¨¡å¼è¿è¡Œï¼Œå½“ä½¿ç”¨Debug|RelWithDebInfoæ¨¡å¼æˆ–è€…æ„å»ºäº†å¸¦æœ‰debugä¿¡æ¯çš„ç¨‹åºæœ‰æ•ˆ  </li>
<li>æœ€å³æ˜¯è¿è¡Œï¼Œç›´æ¥è¿è¡Œ  </li>
</ul>
<p>ä¸‹ä¸€ç« <a href="#%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5">ç°ä»£CMakeçš„æ ¸å¿ƒæ¦‚å¿µ</a></p></section><section class="print-page" id="%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5"><h1 id="%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5-cmake">ç°ä»£CMakeçš„æ ¸å¿ƒæ¦‚å¿µ</h1>
<p><a id="coreconcept"></a></p>
<h3 id="%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5-_1">ç›®æ ‡</h3>
<p><strong><code>ç›®æ ‡ï¼ˆTargetï¼‰</code></strong>æ˜¯ç°ä»£CMakeæœ€æ ¸å¿ƒçš„æ¦‚å¿µã€‚ç›®æ ‡ä»£è¡¨äº†ç”±CMakeæ„å»ºçš„å¯æ‰§è¡Œæ–‡ä»¶ã€åº“å’Œè‡ªå®šä¹‰å‘½ä»¤ã€‚æ¯ä¸ªadd_libraryã€add_executableå’Œadd_custom_targetå‘½ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªç›®æ ‡ã€‚
æ¯ä¸ªå¯¹è±¡å¯ä»¥é™„åŠ å±æ€§ï¼Œå±æ€§æ˜¯é™„åŠ åˆ°ç‰¹å®šå¯¹è±¡çš„é”®å€¼å¯¹ã€‚  </p>
<h4 id="%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5-_2">ç›®æ ‡çš„ä¸»è¦ç‰¹ç‚¹</h4>
<ul>
<li>å…¨å±€ä½œç”¨åŸŸï¼šä¸€æ—¦åˆ›å»ºï¼Œå¯åœ¨é¡¹ç›®ä¸­ä»»ä½•åœ°æ–¹å¼•ç”¨ã€‚</li>
<li>è‡ªåŠ¨æ‰©å±•åï¼šCMakeæ ¹æ®å¹³å°è‡ªåŠ¨å†³å®šæ‰©å±•åï¼ˆå¦‚Windowsä¸‹å¯æ‰§è¡Œæ–‡ä»¶ä¸º.exeï¼‰ã€‚</li>
<li>åŠ¨æ€æŸ¥è¯¢ä¿®æ”¹ï¼šå¯ç”¨set_target_propertieså’Œget_target_propertyåŠ¨æ€æ›´æ–°ç›®æ ‡å±æ€§ã€‚</li>
</ul>
<p>å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆExecutableï¼‰ï¼š</p>
<pre><code>é€šè¿‡add_executableå‘½ä»¤åˆ›å»ºã€‚ä¾‹å¦‚ï¼Œadd_executable(my_app main.cpp)ä¼šåˆ›å»ºä¸€ä¸ªåä¸ºmy_appçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå…¶æºæ–‡ä»¶ä¸ºmain.cppã€‚
</code></pre>
<p>åº“ï¼ˆLibraryï¼‰ï¼š</p>
<pre><code>é€šè¿‡add_libraryå‘½ä»¤åˆ›å»ºã€‚ä¾‹å¦‚ï¼Œadd_library(foo STATIC foo1.c foo2.c)ä¼šåˆ›å»ºä¸€ä¸ªåä¸ºfooçš„é™æ€åº“ï¼Œå…¶æºæ–‡ä»¶ä¸ºfoo1.cå’Œfoo2.cã€‚
</code></pre>
<p>è‡ªå®šä¹‰ç›®æ ‡ï¼ˆCustom Targetï¼‰ï¼š</p>
<pre><code>é€šè¿‡add_custom_targetå‘½ä»¤åˆ›å»ºï¼Œç”¨äºæ‰§è¡Œè‡ªå®šä¹‰çš„æ„å»ºä»»åŠ¡ã€‚
</code></pre>
<h2 id="%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5-usage-requirements">ä½¿ç”¨è¦æ±‚(Usage Requirements)</h2>
<p>åœ¨ CMake ä¸­ï¼Œ<code>ä½¿ç”¨è¦æ±‚</code>ï¼ˆUsage Requirementsï¼‰ä¹Ÿå¯ä»¥è¢«ç§°ä½œâ€œä¼ æ’­æœºåˆ¶â€ï¼Œå®ƒæŒ‡çš„æ˜¯ç›®æ ‡åœ¨æ„å»ºæ—¶çš„è¦æ±‚ï¼Œä»¥åŠè¿™äº›è¦æ±‚å¦‚ä½•ä¼ æ’­ç»™å…¶ä»–é“¾æ¥åˆ°è¯¥ç›®æ ‡çš„ç›®æ ‡ã€‚å¯ä¾›é€‰æ‹©çš„æœ‰<code>PUBLIC ã€ PRIVATE å’Œ INTERFACE</code>ã€‚</p>
<h3 id="%e7%8e%b0%e4%bb%a3cmake%e7%9a%84%e6%a0%b8%e5%bf%83%e6%a6%82%e5%bf%b5-_3">å…·ä½“ä¾‹å­:</h3>
<p>è¯¥ä¾‹å­è¡¨ç¤ºä»»ä½•é“¾æ¥(target_link_libraries)åˆ°ç›®æ ‡ foo çš„ç›®æ ‡éƒ½ä¼šè‡ªåŠ¨å°† foo çš„æºä»£ç ç›®å½•ä½œä¸ºåŒ…å«ç›®å½•ï¼ŒåŒ…æ‹¬è‡ªèº«ã€‚</p>
<pre><code class="language-cmake">add_library(foo foo.cpp)
target_include_directories(foo PUBLIC &quot;${CMAKE_CURRENT_SOURCE_DIR}&quot;)
</code></pre>
<p>å¯¹äºå¦å¤–ä¸¤ç§<code>ä½¿ç”¨è¦æ±‚</code>:</p>
<ul>
<li>ä½¿ç”¨ PRIVATE æ—¶ï¼Œåªæœ‰ foo ç›®æ ‡æœ¬èº«<code>ä¼š</code>å°†æºä»£ç ç›®å½•ä½œä¸ºåŒ…å«ç›®å½•ã€‚å…¶ä»–é“¾æ¥åˆ° foo çš„ç›®æ ‡<code>ä¸ä¼šç»§æ‰¿</code>è¿™ä¸ªåŒ…å«ç›®å½•è®¾ç½®ã€‚  </li>
<li>ä½¿ç”¨ INTERFACE æ—¶ï¼Œfoo æœ¬èº«æœ¬èº«<code>ä¸ä¼š</code>å°†æºä»£ç ç›®å½•ä½œä¸ºåŒ…å«ç›®å½•ï¼Œè€Œæ˜¯ä¸€ä¸ªä»…ä¾›é“¾æ¥çš„ç›®æ ‡ã€‚ä½†æ˜¯ï¼Œå…¶ä»–é“¾æ¥åˆ° foo çš„ç›®æ ‡éƒ½ä¼šè‡ªåŠ¨ç»§æ‰¿ foo è®¾ç½®çš„åŒ…å«ç›®å½•ã€‚</li>
</ul>
<p>ä¸‹ä¸€ç« <a href="#%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba">æœ€å°æ„å»º.md</a></p></section><section class="print-page" id="%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba"><h1 id="%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba-cmakelists">æœ€å°çš„CMakeListsæ¡ˆä¾‹</h1>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»é›¶å¼€å§‹åˆ›å»ºä¸€ä¸ªç®€å•çš„ C++ é¡¹ç›®ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ CMake æ„å»ºä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>
<h3 id="%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba-_1"><strong>å‡†å¤‡æºä»£ç ä¸é…ç½®æ–‡ä»¶</strong></h3>
<p>åˆ›å»º main.cpp æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-cpp">// main.cpp
#include &lt;iostream&gt;
int main(){
    puts(&quot;hello cmake&quot;);
}
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º CMakeLists.txt æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="language-cmake">
# è®¾ç½® CMake çš„æœ€ä½ç‰ˆæœ¬
cmake_minimum_required(VERSION 3.20)

# è®¾ç½®é¡¹ç›®åç§°
project(MinimalCMakeProject)

# å®šä¹‰ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶
# ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æºæ–‡ä»¶è·¯å¾„
add_executable(hello_cmake main.cpp)
</code></pre>
<h3 id="%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba-_2">é…ç½®é¡¹ç›®</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æ„å»ºç›®å½•(ä¹Ÿç§°ä¸ºæºå¤–æ„å»º)ã€‚</p>
<blockquote>
<p>ä¸ºä»€ä¹ˆä½¿ç”¨ç‹¬ç«‹æ„å»ºç›®å½•ï¼Ÿ
è¿™æ ·å¯ä»¥å°†ç”Ÿæˆçš„æ„å»ºæ–‡ä»¶ä¸æºä»£ç åˆ†ç¦»ï¼Œä¿æŒé¡¹ç›®ç›®å½•æ•´æ´ï¼Œä¾¿äºç®¡ç†ã€‚</p>
</blockquote>
<pre><code class="language-bash">cmake -S . -B build
</code></pre>
<p><code>-S .</code> è¡¨ç¤ºè®© CMake æŸ¥æ‰¾å½“å‰ç›®å½•ä¸­çš„ CMakeLists.txt æ–‡ä»¶ï¼Œ<code>-B build</code> æŒ‡å®šæ„å»ºæ–‡ä»¶å­˜æ”¾åœ¨ build ç›®å½•ã€‚æ‰§è¡Œåï¼ŒCMake ä¼šç”Ÿæˆå¹³å°ç›¸å…³çš„æ„å»ºæ–‡ä»¶ã€‚
æˆåŠŸåï¼Œç»ˆç«¯å°†è¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre><code class="language-bash">awe@build$ cmake ..
-- The C compiler identification is GNU 14.2.1
-- The CXX compiler identification is GNU 14.2.1
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /usr/bin/cc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Configuring done (0.5s)
-- Generating done (0.0s)
-- Build files have been written to: /home/awe/Desktop/code/node/Modern-CMake/examples/step1/build
</code></pre>
<h3 id="%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba-_3">ç”Ÿæˆé¡¹ç›®</h3>
<p>åœ¨CMakeLists.txtæ‰€åœ¨ç›®å½•ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="language-bash">cmake --build build
</code></pre>
<p>æˆåŠŸåï¼Œä½ å°†çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºï¼š</p>
<pre><code class="language-bash">awe@build$ cmake --build .
[ 50%] Building CXX object CMakeFiles/hello_cmake.dir/main.cpp.o
[100%] Linking CXX executable hello_cmake
[100%] Built target hello_cmake
</code></pre>
<p>ç¼–è¯‘å®Œæˆåï¼Œå¯æ‰§è¡Œæ–‡ä»¶ä¼šå‡ºç°åœ¨ build ç›®å½•ä¸‹ï¼Œè¿è¡Œå®ƒï¼š</p>
<pre><code class="language-bash">./build/hello_cmake
</code></pre>
<p>æœ€ç»ˆå¯æ‰§è¡Œç›®å½•ç»“æ„:</p>
<pre><code class="language-bash">awe@step1$ tree -L 2
.
â”œâ”€â”€ build
â”‚   â”œâ”€â”€ CMakeCache.txt
â”‚   â”œâ”€â”€ CMakeFiles
â”‚   â”œâ”€â”€ cmake_install.cmake
â”‚   â”œâ”€â”€ hello_cmake
â”‚   â””â”€â”€ Makefile
â”œâ”€â”€ CMakeLists.txt
â””â”€â”€ main.cpp
</code></pre>
<h3 id="%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba-cmake">ä¸ºä»€ä¹ˆCMakeæ„å»ºè¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥ï¼Ÿ</h3>
<p><strong>é…ç½®é˜¶æ®µ</strong> (<code>cmake -S . -B build</code>)ï¼šé…ç½®é˜¶æ®µåªè§£æé¡¹ç›®ç»“æ„å’Œç”Ÿæˆè§„åˆ™ï¼Œä¸æ‰§è¡Œå®é™…çš„ç¼–è¯‘å·¥ä½œã€‚</p>
<pre><code>é…ç½®é˜¶æ®µ,CMakeä¼šè§£æ CMakeLists.txt æ–‡ä»¶ï¼Œç”Ÿæˆé€‚åˆå½“å‰å¹³å°çš„æ„å»ºæ–‡ä»¶ï¼ˆå¦‚ Makefile æˆ– Visual Studio å·¥ç¨‹æ–‡ä»¶.slnç­‰ï¼›å¯¹äºç°åœ¨çš„IDE,VS,CLionç­‰éƒ½ä¼šåœ¨CMakeLists.txtæ–‡ä»¶æ›´æ–°å(åŠ)è‡ªåŠ¨é…ç½®ï¼Œä¸å¿…æ‰‹åŠ¨å®Œæˆï¼‰ï¼Œè€Œä¸”é…ç½®è¿‡ç¨‹æ˜¯æœ‰ç¼“å­˜çš„,ç¬¬ä¸€æ¬¡æ„å»ºåç¬¬äºŒæ¬¡é…ç½®å¯ä»¥,CMake build/ ç›´æ¥æŒ‡å®šä¸Šæ¬¡æ„å»ºçš„ç¼“å­˜ï¼Œæ¯æ¬¡å¢é‡æ›´æ–°`cmake build/ -DCMAKE_XXX=YYY`(ä¸ä¸è¿‡è¿™äº›æ„å»ºç¼“å­˜ä¸€èˆ¬ä¹Ÿä¸èƒ½è¿ç§»åˆ°å…¶ä»–ç›®å½•ï¼Œcmakeæ— æ³•ä¿è¯è¿™ä¸ªï¼‰ã€‚
</code></pre>
<p><strong>ç”Ÿæˆé˜¶æ®µ</strong>(<code>cmake --build build</code>)ï¼š</p>
<blockquote>
<p>tips: cmake --build build -v å¯ä»¥è¾“å‡ºå…·ä½“çš„ç¼–è¯‘è¿‡ç¨‹</p>
</blockquote>
<pre><code>CMakeä½¿ç”¨ç¬¬ä¸€æ­¥ç”Ÿæˆçš„æ„å»ºæ–‡ä»¶ï¼Œé€šè¿‡æ„å»ºæ–‡ä»¶è°ƒç”¨å¯¹åº”çš„æ„å»ºå·¥å…·(msbuildã€makeã€ninja)å®Œæˆæ„å»ºï¼Œæ„å»ºå·¥å…·æ¥è°ƒç”¨å…·ä½“çš„ç¼–è¯‘å™¨ï¼ˆå¦‚ g++ã€clang++ æˆ– cl.exeï¼‰è¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆå¦‚å¯æ‰§è¡Œæ–‡ä»¶.exeæˆ–åº“ï¼‰ã€‚
</code></pre>
<h2 id="%e6%9c%80%e5%b0%8f%e6%9e%84%e5%bb%ba-cmake_1">CMake é…ç½®æ–‡ä»¶å†…å®¹çš„å†™ä»€ä¹ˆï¼Ÿ</h2>
<p>CMake é…ç½®æ–‡ä»¶çš„æ ¸å¿ƒä½œç”¨æ˜¯å‘Šè¯‰ CMake å¦‚ä½•å°†<code>æºä»£ç å’Œåº“æ–‡ä»¶</code>è½¬æ¢ä¸º<code>å¯æ‰§è¡Œæ–‡ä»¶æˆ–å…¶ä»–ç›®æ ‡</code>ã€‚</p>
<p>åœ¨ç°ä»£ CMake ä¸­ï¼Œæ„å»ºçš„æ ¸å¿ƒæ˜¯<a href="#ç°ä»£cmakeçš„æ ¸å¿ƒæ¦‚å¿µ-coreconcept">Target</a>ã€‚Target å¯ä»¥æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ã€åº“æ–‡ä»¶ï¼Œç”šè‡³æ˜¯è‡ªå®šä¹‰å‘½ä»¤ã€‚
ä¸€ä¸ªåŸºæœ¬çš„ç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ª Targetï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<pre><code class="language-cmake"># CMakeè¦æ±‚ç¬¬ä¸€è¡Œå¿…é¡»æ˜¯cmake_minimum_required VERSIONæ¨è3.20èµ·æ­¥ï¼Œ
cmake_minimum_required(VERSION 3.20)
# CMakeè§„å®šä¸€ä¸ªé¡¹ç›®çš„æ ¹CMakeLists.txtå¿…é¡»è¦æœ‰é¡¹ç›®åå­—ã€‚
project(MinimalCMakeProject)

add_executable(hello_cmake main.cpp)
</code></pre>
<details>
<summary>ä¸Šæ–‡CMakeå‘½ä»¤è¯¦è§£</summary>
<div style="padding-left: 2em;">
    <h3>1. cmake_minimum_required</h3>
    <p>
        <strong>æ¨èç‰ˆæœ¬ï¼š</strong>ä» 3.20 èµ·æ­¥ã€‚<br>
        æ­¤å‘½ä»¤ä¸ä»…è¦æ±‚ CMake çš„æœ€ä½ç‰ˆæœ¬ï¼Œè¿˜ä¼šè®¾å®šç­–ç•¥ç‰ˆæœ¬ã€‚
    </p>
    <p><strong>ç­‰ä»·å‘½ä»¤ï¼š</strong><br>
        <code>cmake_policy(VERSION 3.20)</code>
    </p>
    <p>CMake ä¸­çš„ç­–ç•¥ç‰ˆæœ¬ç”¨äºåœ¨å¤šä¸ªç‰ˆæœ¬ä¹‹é—´ä¿ç•™å‘åå…¼å®¹çš„è¡Œä¸ºã€‚</p>

    <hr>

    <h3>2. project</h3>
    <p>project å‘½ä»¤å¯ä»¥è®¾ç½®ä»¥ä¸‹å†…å®¹ï¼š</p>
    <ul>
        <li><strong>VERSION</strong>: é¡¹ç›®çš„ç‰ˆæœ¬å·ã€‚</li>
        <li><strong>DESCRIPTION</strong>: é¡¹ç›®çš„æè¿°ã€‚</li>
        <li><strong>HOMEPAGE_URL</strong>: é¡¹ç›®ä¸»é¡µåœ°å€ã€‚</li>
        <li><strong>LANGUAGES</strong>: é¡¹ç›®æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ã€‚</li>
    </ul>
    <p>
        è°ƒç”¨ <code>project</code> åï¼Œä¼šå®šä¹‰ä¸€ç³»åˆ—æœ‰ç”¨çš„å˜é‡ï¼Œä¾‹å¦‚ï¼š
    </p>
    <ul>
        <li><strong>PROJECT_SOURCE_DIR</strong>: é¡¹ç›®æºç çš„æ ¹ç›®å½•ã€‚</li>
        <li><strong>&lt;PROJECT-NAME&gt;_SOURCE_DIR</strong>: å½“å‰é¡¹ç›®çš„æºç ç›®å½•ã€‚</li>
    </ul>

    <blockquote>
        <strong>æ³¨æ„ï¼š</strong><br>
        å¦‚æœ <code>project</code> ä½äºé¡¶å±‚ CMakeLists.txtï¼ˆæ ¹çº§åˆ«ï¼‰ï¼Œä¼šè®¾ç½®ä»¥ä¸‹å˜é‡ï¼š
        <ul>
            <li><strong>CMAKE_PROJECT_NAME</strong>: é¡¶å±‚é¡¹ç›®çš„åç§°ï¼ˆä»…æ ¹é¡¹ç›®è®¾ç½®ï¼‰ã€‚</li>
            <li><strong>PROJECT_NAME</strong>: å½“å‰é¡¹ç›®çš„åç§°ï¼ˆæœ€è¿‘è°ƒç”¨çš„ <code>project</code> å‘½ä»¤è¦†ç›–ä¹‹å‰çš„å€¼ï¼‰ã€‚</li>
        </ul>
    </blockquote>
</div>
</details>

<p>ä¸‹ä¸€ç« <a href="#find_packageæ¡ˆä¾‹">find_packageæ¡ˆä¾‹.md</a></p></section><section class="print-page" id="find_package%e6%a1%88%e4%be%8b"><h1 id="find_package%e6%a1%88%e4%be%8b-find_package">find_packageæ¡ˆä¾‹</h1>
<p>è¿™ä¸€ç« æ˜¯ä¸€ä¸ª <strong><code>find_package</code> æ¡ˆä¾‹</strong> çš„æ¡ˆä¾‹ï¼Œå¤§éƒ¨åˆ†åˆå­¦è€…ä¼šç»å¸¸å› ä¸ºè¿™ä¸ªå‘½ä»¤æ‰¾ä¸åˆ°åº“è€ŒæŠ¥é”™(æ˜æ˜åˆ«äººèƒ½è·‘ğŸ¤”)ï¼š  </p>
<h3 id="find_package%e6%a1%88%e4%be%8b-1-find_package">1. <strong>find_packageåŸºç¡€æ¡ˆä¾‹</strong></h3>
<p>ç¤ºä¾‹ï¼š<code>SDL2</code> åŒ…å¹¶æ„å»ºä¸€ä¸ªsdl2_demoã€‚</p>
<pre><code class="language-cmake">cmake_minimum_required(VERSION 3.20)

# ç”Ÿæˆ&lt;build_dir&gt;/compile_commands.json
set(CMAKE_EXPORT_COMPILE_COMMANDS TRUE)

# SDL2_DIR å¿…é¡»æŒ‡å®šåˆ°.cmakeæ‰€åœ¨è·¯å¾„ 
set(SDL2_DIR /home/awe/Desktop/clone/learn_SDL2/3rd/install/lib64/cmake/SDL2)

# SDL2_ROOT æŒ‡å®šåˆ°installæ—¢å¯ï¼Œ`lib64/cmake/SDL2`ä¼šè‡ªåŠ¨åŒ¹é…
# set(SDL2_ROOT /home/awe/Desktop/clone/learn_SDL2/3rd/install)

# CMAKE_PREFIX_PATHåŒSDL2_ROOTéƒ½æŒ‰ç…§å‰ç¼€æœç´¢è§„åˆ™æ¨¡ç³Šæœç´¢
# set(CMAKE_PREFIX_PATH /home/awe/Desktop/clone/learn_SDL2/3rd/install)
project(MinimalCMakeProject)

add_executable(sdl2_demo main.cpp)

# æŸ¥æ‰¾SDL2åº“
find_package(SDL2)
target_link_libraries(sdl2_demo SDL2::SDL2)
</code></pre>
<h3 id="find_package%e6%a1%88%e4%be%8b-2-find_package">2. find_packageè¯¦è§£</h3>
<h4 id="find_package%e6%a1%88%e4%be%8b-_1">é»˜è®¤æœç´¢æ¨¡å¼</h4>
<p><code>find_package</code> åŸºæœ¬è¯­æ³•ï¼š<br />
<code>find_package(&lt;PackageName&gt; [&lt;version&gt;] [REQUIRED] [COMPONENTS &lt;components&gt;...])</code></p>
<p><code>find_package</code> æ‰¾åˆ°ä¸€ä¸ªåŒ…ï¼ˆé€šå¸¸ç”±é¡¹ç›®å¤–éƒ¨çš„ä¸œè¥¿æä¾›ï¼‰ï¼Œå¹¶åŠ è½½å…¶è¿™ä¸ªåŒ…ã€‚
<code>find_package</code> è¯¥å‘½ä»¤æœ‰å‡ ç§æœç´¢åŒ…çš„æ¨¡å¼,é»˜è®¤å…ˆæŒ‰ç…§æ¨¡å—æ¨¡å¼æœç´¢ï¼ŒåæŒ‰ç…§é…ç½®æ¨¡å¼æœç´¢ï¼š</p>
<ul>
<li>æ¨¡å—æ¨¡å¼ï¼ˆModule modeï¼‰ï¼š<br />
åœ¨æ­¤æ¨¡å¼ä¸‹ï¼ŒCMake æœç´¢åä¸º<code>Find&lt;PackageName&gt;.cmake</code>çš„æ–‡ä»¶ï¼Œé¦–å…ˆåœ¨<code>CMAKE_MODULE_PATH</code>ä¸­åˆ—å‡ºçš„ä½ç½®ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œåˆ™ç”± CMake è¯»å–å¹¶å¤„ç†è¯¥æ–‡ä»¶ã€‚</li>
<li>é…ç½®æ¨¡å¼ï¼ˆConfig Modeï¼‰: 
     åœ¨æ­¤æ¨¡å¼ä¸‹ï¼ŒCMake æœç´¢åä¸ºçš„æ–‡ä»¶ &lt;lowercasePackageName&gt;-config.cmake ã€&lt;PackageName&gt;Config.cmakeï¼Œå¦‚æœæŒ‡å®šäº†<version>é€‰é¡¹è¿˜ä¼šå…ˆæŸ¥æ‰¾ &lt;lowercasePackageName&gt;-config-version.cmakeã€&lt;PackageName&gt;ConfigVersion.cmakeã€‚  </li>
</ul>
<h4 id="find_package%e6%a1%88%e4%be%8b-_2">æŒ‡å®šæœç´¢æ¨¡å¼</h4>
<p><code>find_package</code>æ”¯æŒé€šè¿‡<code>MODULE|CONFIG</code>é€‰é¡¹æ¥é€‰æ‹©æŸä¸€ç§æœç´¢æ¨¡å¼
<code>find_package(&lt;PackageName&gt; [...] [MODULE|CONFIG])</code>    </p>
<p><code>find_package</code>æŸ¥æ‰¾ä¼šæ ¹æ®ä»¥ä¸‹å˜é‡æŸ¥æ‰¾ä¸Šæ–‡åˆ—å‡ºçš„.cmakeæ–‡ä»¶(å¸¸ç”¨çš„)ï¼š
CMAKE_PREFIX_PATHã€&lt;PackageName&gt;_DIRã€&lt;PackageName&gt;_ROOTã€CMAKE_INSTALL_PREFIX(ä¸æ¨è)ã€ç¯å¢ƒå˜é‡PATHã€‚</p>
<h4 id="find_package%e6%a1%88%e4%be%8b-_3">æ ¹æ®å‰ç¼€æœç´¢</h4>
<p>ä¸€èˆ¬æ˜¯è®¾ç½®<strong><code>CMAKE_PREFIX_PATH</code></strong> ï¼Œä¸»è¦é å®ƒä½œä¸ºæœç´¢<strong><code>å‰ç¼€</code></strong>ï¼Œå¹¶æŒ‰ç…§æœç´¢è§„åˆ™æ‰¾åˆ°.cmakeæ–‡ä»¶ï¼›ä¸è¿‡å¯¹äº&lt;PackageName&gt;_DIRæ˜¯å¿…é¡»æŒ‡å®šåˆ°.cmakeæ‰€åœ¨ç›®å½•çš„ã€‚
æœç´¢<strong><code>å‰ç¼€</code></strong>çš„æœç´¢è§„åˆ™(<a href="https://cmake.org/cmake/help/latest/command/find_package.html#config-mode-search-procedure">å®Œæ•´æœç´¢è§„åˆ™å‚è€ƒ</a>)ï¼š<br />
é€‚ç”¨äºunixç³»çš„çº¦å®š:</p>
<pre><code class="language-txt">&lt;prefix&gt;/(lib/&lt;arch&gt;|lib*|share)/cmake/&lt;name&gt;*/

&lt;prefix&gt;/(lib/&lt;arch&gt;|lib*|share)/&lt;name&gt;*/

&lt;prefix&gt;/(lib/&lt;arch&gt;|lib*|share)/&lt;name&gt;*/(cmake|CMake)/
</code></pre>
<p>é€‚ç”¨äºunix/windowsçš„çº¦å®šï¼š</p>
<pre><code class="language-txt">&lt;prefix&gt;/&lt;name&gt;*/(lib/&lt;arch&gt;|lib*|share)/cmake/&lt;name&gt;*/

&lt;prefix&gt;/&lt;name&gt;*/(lib/&lt;arch&gt;|lib*|share)/&lt;name&gt;*/

&lt;prefix&gt;/&lt;name&gt;*/(lib/&lt;arch&gt;|lib*|share)/&lt;name&gt;*/(cmake|CMake)/
</code></pre>
<p>é€‚ç”¨äºmacçš„çº¦å®šï¼š</p>
<pre><code class="language-txt">&lt;prefix&gt;/&lt;name&gt;.framework/Resources/CMake/

&lt;prefix&gt;/&lt;name&gt;.framework/Versions/*/Resources/

&lt;prefix&gt;/&lt;name&gt;.framework/Versions/*/Resources/CMake/
</code></pre>
<hr />
<details>
<summary>å®Œæ•´çš„ CMakeLists.txt å’Œ main.cpp ç¤ºä¾‹ä»£ç (examples/step3)</summary>

<pre><code class="cmake">
cmake_minimum_required(VERSION 3.20)

set(CMAKE_EXPORT_COMPILE_COMMANDS TRUE)

# åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶
add_executable(find_lib_demo main.cpp)

# æŸ¥æ‰¾ SDL2 åº“
find_package(SDL2)

# ç»™find_lib_demoè¿™ä¸ªç›®æ ‡é“¾æ¥ SDL2 åº“
target_link_libraries(find_lib_demo SDL2::SDL2)
</code></pre>

<pre><code class="cpp">
#include &lt;SDL.h&gt;
#include &lt;iostream&gt;

int main(int argc, char* args[]) {
    // åˆå§‹åŒ–SDL
    if (SDL_Init(SDL_INIT_VIDEO) < 0) {
        std::cerr << "SDL could not initialize! SDL_Error: " << SDL_GetError() << std::endl;
        return -1;
    }

    // åˆ›å»ºçª—å£
    SDL_Window* window = SDL_CreateWindow("SDL Demo", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, 640, 480, SDL_WINDOW_SHOWN);
    if (window == nullptr) {
        std::cerr << "Window could not be created! SDL_Error: " << SDL_GetError() << std::endl;
        SDL_Quit();
        return -1;
    }

    // åˆ›å»ºæ¸²æŸ“å™¨
    SDL_Renderer* renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED);
    if (renderer == nullptr) {
        std::cerr << "Renderer could not be created! SDL_Error: " << SDL_GetError() << std::endl;
        SDL_DestroyWindow(window);
        SDL_Quit();
        return -1;
    }

    // è®¾ç½®ç»˜åˆ¶é¢œè‰²ä¸ºè“è‰²
    SDL_SetRenderDrawColor(renderer, 0, 0, 255, 255);

    // æ¸…é™¤å±å¹•
    SDL_RenderClear(renderer);

    // ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢
    SDL_Rect rect = {100, 100, 200, 150};
    SDL_RenderFillRect(renderer, &rect);

    // æ›´æ–°å±å¹•æ˜¾ç¤º
    SDL_RenderPresent(renderer);

    // äº‹ä»¶å¤„ç†
    bool quit = false;
    SDL_Event e;
    while (!quit) {
        while (SDL_PollEvent(&e) != 0) {
            if (e.type == SDL_QUIT) {
                quit = true;
            }
        }
    }

    // é‡Šæ”¾èµ„æºå¹¶é€€å‡º
    SDL_DestroyRenderer(renderer);
    SDL_DestroyWindow(window);
    SDL_Quit();

    return 0;
}
</code></pre>

</details>
<p>ä¸‹ä¸€ç« <a href="#cmakepresets">CMakePresets.jsonæ¡ˆä¾‹</a></p></section><section class="print-page" id="cmakepresets"><h1 id="cmakepresets-cmakepresetsjson">CMakePresets.json</h1>
<p>CMake ç”¨æˆ·ç»å¸¸é¢ä¸´çš„ä¸€ä¸ªé—®é¢˜å¦‚ä½•å…¶ä»–äººå…±äº«é…ç½®(å¯èƒ½éœ€è¦å†™run.sh run.ps1 run.bat)ã€‚<br />
è‡ªCMake 3.19èµ·æ”¯æŒç”¨jsoné…ç½®å¹¶è¿è¡Œé¡¹ç›®ï¼ŒCMake ä¸»è¦æ”¯æŒä¸¤ä¸ªæ–‡ä»¶CMakePresets.jsonå’ŒCMakeUserPresets.json(è¦æ±‚ä½äºé¡¹ç›®æ ¹ç›®å½•,ä½¿ç”¨presetæ„å»ºåˆ™å¿…é¡»è‡³å°‘å­˜åœ¨ä¸€ä¸ªpresetï¼‰ã€‚</p>
<blockquote>
<p>ä¸¤ä¸ªpreset.jsonæ²¡æœ‰å†…å®¹å·®å¼‚ã€‚CMakePresets.jsonæ˜¯é¢å‘æ‰€æœ‰ç”¨æˆ·çš„(ç†åº”æäº¤åˆ°git)ï¼ŒCMakeUserPresets.jsonåº”æ·»åŠ åˆ°.gitignore</p>
</blockquote>
<h2 id="cmakepresets-_1">å…·ä½“æ¡ˆä¾‹</h2>
<h3 id="cmakepresets-_2">å‡†å¤‡æºä»£ç ä¸é…ç½®æ–‡ä»¶</h3>
<p>ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="language-txt">$ tree 
.
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ CMakePresets.json
â””â”€â”€ main.cpp
</code></pre>
<p>ä¸»è¦çœ‹CMakePresets.json(example/step4)å¤§æ¦‚å¦‚ä¸‹ï¼š</p>
<pre><code class="language-json">{
  &quot;version&quot;: 9,
  &quot;configurePresets&quot;: [
    {
      &quot;name&quot;: &quot;config-default&quot;,
      &quot;description&quot;: &quot;Default configuration&quot;,
      &quot;generator&quot;: &quot;Ninja&quot;,
      &quot;binaryDir&quot;: &quot;${sourceDir}/build/default&quot;,
      &quot;cacheVariables&quot;: {
        &quot;CMAKE_BUILD_TYPE&quot;: &quot;Debug&quot;,
       &quot;CMAKE_INSTALL_PREFIX&quot;: &quot;${sourceDir}/install&quot;
      }
    },
    {
      &quot;name&quot;: &quot;config-release&quot;,
      &quot;description&quot;: &quot;Release configuration&quot;,
      &quot;generator&quot;: &quot;Ninja&quot;,
      &quot;binaryDir&quot;: &quot;${sourceDir}/build/release&quot;,
      &quot;cacheVariables&quot;: {
        &quot;CMAKE_BUILD_TYPE&quot;: &quot;Release&quot;,
        &quot;CMAKE_INSTALL_PREFIX&quot;: &quot;${sourceDir}/release-install&quot;
      }
    }
  ],
  &quot;buildPresets&quot;: [
    {
      &quot;name&quot;: &quot;build-default&quot;,
      &quot;configurePreset&quot;: &quot;config-default&quot;,
      &quot;jobs&quot;: 8
    },
    {
      &quot;name&quot;: &quot;build-release&quot;,
      &quot;configurePreset&quot;: &quot;config-release&quot;,
      &quot;jobs&quot;: 8
    }
  ]
}
</code></pre>
<h3 id="cmakepresets-_3">è¿è¡Œ:</h3>
<p>æŒ‰ç…§é€šå¸¸çš„cmakeé¡¹ç›®æ„å»ºæ­¥éª¤ï¼Œå…ˆé…ç½®ï¼Œåæ„å»ºã€‚</p>
<pre><code class="language-bash">$ cmake --list-presets # è¾“å‡ºçœ‹æ˜¯å¦cmakeprestæ ¼å¼æ— è¯¯
Available configure presets:

  &quot;config-default&quot;
  &quot;config-release&quot;
$ cmake --preset config-default # é€‰æ‹©é…ç½®`config-default`,ç”Ÿæˆ&quot;binaryDir&quot;ä¸­æŒ‡å®šçš„ç›®å½•build/default

$ cmake --build --list-presets # è¾“å‡ºå¯ç”¨çš„build presets(å¯é€‰)
Available build presets:

  &quot;build-default&quot;
  &quot;build-release&quot;

$ cmake --build --preset build-default # æ‰§è¡Œæ„å»º,ç”Ÿæˆbuild/default/cmake_presetå¯æ‰§è¡Œç¨‹åº
</code></pre>
<h2 id="cmakepresets-cmakepresetsjson_1">CMakePresets.json å…·ä½“å‚æ•°:</h2>
<p>è¿™é‡Œçš„CMakePresets.jsonå‚æ•°éå¸¸ç®€å•ï¼Œæ˜¯å®Œå…¨å¯ä»¥å¯¹åº”åˆ°å…·ä½“çš„cmakeå‘½ä»¤ä¸Šã€‚<br />
é…ç½®é˜¶æ®µå‚æ•°:</p>
<pre><code>generatorå¯¹åº”-G Ninja
binaryDirå¯¹åº”-B ./build/default
CMAKE_BUILD_TYPEå¯¹åº” -D CMAKE_BUILD_TYPE=Debug
CMAKE_INSTALL_PREFIXå¯¹åº” -D CMAKE_INSTALL_PREFIX=./install
</code></pre>
<p>æ„å»ºé˜¶æ®µå‚æ•°ï¼š</p>
<pre><code>jobså¯¹åº” -j/--parallel 8
</code></pre>
<h2 id="cmakepresets-cmakepreset">cmakepresetå¤ç”¨</h2>
<p>CMakeUserPresets.jsonå¯ä»¥ä½¿ç”¨æ–‡ä»¶çš„includeå­—æ®µåŒ…å«å…¶ä»–æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ‰€åŒ…å«çš„æ–‡ä»¶è¿˜å¯ä»¥åŒ…å«å…¶ä»–æ–‡ä»¶ã€‚å¦‚æœCMakePresets.jsonå’Œ CMakeUserPresets.jsonéƒ½å­˜åœ¨ï¼Œ CMakeUserPresets.json åœ¨æ ¼å¼çš„æ‰€æœ‰ç‰ˆæœ¬ä¸­éšå¼åŒ…å«CMakePresets.json ï¼Œå³ä½¿æ²¡æœ‰includeå­—æ®µã€‚
å…·ä½“ä¾‹å­ï¼š<br />
ä¾‹å­æ ¹æ®ä¸Šé¢çš„æ¡ˆä¾‹ï¼Œæ–°å¢ä¸€ä¸ªCMakeUserPresets.json</p>
<pre><code class="language-json">{
    &quot;version&quot;: 9,
    &quot;configurePresets&quot;: [
        {
            &quot;inherits&quot;: &quot;config-default&quot;,
            &quot;name&quot;: &quot;myconfig&quot;,
            &quot;cacheVariables&quot;: {
                &quot;CMAKE_BUILD_TYPE&quot;: &quot;Debug&quot;,
                &quot;CMAKE_INSTALL_PREFIX&quot;: &quot;${sourceDir}/myinstall&quot;
            }
        }
    ]
}
</code></pre>
<pre><code class="language-bash">$ cmake --list-presets # CMakeUserPresets.jsonéšå¼åŒ…å«CMakePresets.json
Available configure presets:

  &quot;myconfig&quot;
  &quot;config-default&quot;
  &quot;config-release&quot;

$ cmake --build --list-presets
Available build presets:

  &quot;build-default&quot;
  &quot;build-release&quot;  
</code></pre>
<details>
<summary>å®Œæ•´çš„ CMakeLists.txt å’Œ main.cpp ç¤ºä¾‹ä»£ç (examples/step4)</summary>

<pre><code class="cmake">
cmake_minimum_required(VERSION 3.20)

set(CMAKE_EXPORT_COMPILE_COMMANDS TRUE)

# åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶
add_executable(find_lib_demo main.cpp)

# æŸ¥æ‰¾ SDL2 åº“
find_package(SDL2)

# ç»™find_lib_demoè¿™ä¸ªç›®æ ‡é“¾æ¥ SDL2 åº“
target_link_libraries(find_lib_demo SDL2::SDL2)
</code></pre>

<pre><code class="cpp">
#include &lt;SDL.h&gt;
#include &lt;iostream&gt;

int main(int argc, char* args[]) {
    // åˆå§‹åŒ–SDL
    if (SDL_Init(SDL_INIT_VIDEO) < 0) {
        std::cerr << "SDL could not initialize! SDL_Error: " << SDL_GetError() << std::endl;
        return -1;
    }

    // åˆ›å»ºçª—å£
    SDL_Window* window = SDL_CreateWindow("SDL Demo", SDL_WINDOWPOS_UNDEFINED, SDL_WINDOWPOS_UNDEFINED, 640, 480, SDL_WINDOW_SHOWN);
    if (window == nullptr) {
        std::cerr << "Window could not be created! SDL_Error: " << SDL_GetError() << std::endl;
        SDL_Quit();
        return -1;
    }

    // åˆ›å»ºæ¸²æŸ“å™¨
    SDL_Renderer* renderer = SDL_CreateRenderer(window, -1, SDL_RENDERER_ACCELERATED);
    if (renderer == nullptr) {
        std::cerr << "Renderer could not be created! SDL_Error: " << SDL_GetError() << std::endl;
        SDL_DestroyWindow(window);
        SDL_Quit();
        return -1;
    }

    // è®¾ç½®ç»˜åˆ¶é¢œè‰²ä¸ºè“è‰²
    SDL_SetRenderDrawColor(renderer, 0, 0, 255, 255);

    // æ¸…é™¤å±å¹•
    SDL_RenderClear(renderer);

    // ç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢
    SDL_Rect rect = {100, 100, 200, 150};
    SDL_RenderFillRect(renderer, &rect);

    // æ›´æ–°å±å¹•æ˜¾ç¤º
    SDL_RenderPresent(renderer);

    // äº‹ä»¶å¤„ç†
    bool quit = false;
    SDL_Event e;
    while (!quit) {
        while (SDL_PollEvent(&e) != 0) {
            if (e.type == SDL_QUIT) {
                quit = true;
            }
        }
    }

    // é‡Šæ”¾èµ„æºå¹¶é€€å‡º
    SDL_DestroyRenderer(renderer);
    SDL_DestroyWindow(window);
    SDL_Quit();

    return 0;
}
</code></pre>

</details>

<p>ä¸‹ä¸€ç« <a href="#è®¾ç½®ç›®æ ‡å±æ€§">è®¾ç½®ç›®æ ‡å±æ€§</a></p></section><section class="print-page" id="%e8%ae%be%e7%bd%ae%e7%9b%ae%e6%a0%87%e5%b1%9e%e6%80%a7"><h1 id="%e8%ae%be%e7%bd%ae%e7%9b%ae%e6%a0%87%e5%b1%9e%e6%80%a7-_1">è®¾ç½®ç›®æ ‡å±æ€§</h1>
<p>åœ¨ CMake ä¸­ï¼Œæ¯ä¸ª add_executable æˆ– add_library ç›®æ ‡éƒ½æœ‰ä¸€ç³»åˆ—å¯é…ç½®çš„å±æ€§ï¼Œä¾‹å¦‚ è¾“å‡ºç›®å½•ã€æ–‡ä»¶åã€æ–‡ä»¶åç¼€ ç­‰ã€‚CMake æä¾›äº† set_target_properties å‘½ä»¤ï¼Œç”¨äºä¿®æ”¹è¿™äº›å±æ€§ï¼Œä»¥æ»¡è¶³é¡¹ç›®ç»„ç»‡éœ€æ±‚ã€‚<a href="https://cmake.org/cmake/help/latest/manual/cmake-properties.7.html#properties-on-targets">å®Œæ•´ç›®æ ‡å±æ€§åˆ—è¡¨</a>(examples/step5/)</p>
<h2 id="%e8%ae%be%e7%bd%ae%e7%9b%ae%e6%a0%87%e5%b1%9e%e6%80%a7-_2">ç¤ºä¾‹è§£æ</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹é¡¹ç›®ç»“æ„ï¼š</p>
<pre><code class="language-bash">awe@project1$ tree 
.
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ foo.cpp
â”œâ”€â”€ run.sh
â””â”€â”€ test.cpp
awe@project1$ cat run.sh 
rm build target -rf # åˆ é™¤ç¼“å­˜ï¼Œä¿æŒå¹²å‡€
cmake -S . -B build  &amp;&amp;  
cmake --build build -j 4
</code></pre>
<pre><code class="language-cmake">cmake_minimum_required(VERSION 3.20)

project(project1)

add_executable(main test.cpp)

add_library(foo SHARED foo.cpp)

add_library(foo-static STATIC foo.cpp)

set_target_properties(foo
    PROPERTIES
    LIBRARY_OUTPUT_DIRECTORY ../target/lib/
    LIBRARY_OUTPUT_NAME hello_foo
    SUFFIX .so.1
)

set_target_properties(foo-static
    PROPERTIES
    ARCHIVE_OUTPUT_DIRECTORY ../target/lib/
    LIBRARY_OUTPUT_NAME hello_foo-static
    SUFFIX .lib
)

set_target_properties(main
    PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY ../target/bin
    RUNTIME_OUTPUT_NAME project_main
    SUFFIX .exe
)
</code></pre>
<h2 id="%e8%ae%be%e7%bd%ae%e7%9b%ae%e6%a0%87%e5%b1%9e%e6%80%a7-runsh">è¿è¡Œrun.shç»“æœï¼š</h2>
<pre><code class="language-bash">(base) awe@project1$ tree target/
target/
â”œâ”€â”€ bin
â”‚   â””â”€â”€ project_main.exe
â””â”€â”€ lib
    â”œâ”€â”€ libfoo-static.lib
    â””â”€â”€ libhello_foo.so.1
</code></pre>
<h2 id="%e8%ae%be%e7%bd%ae%e7%9b%ae%e6%a0%87%e5%b1%9e%e6%80%a7-set_target_properties">set_target_propertiesï¼š</h2>
<p>ç”¨äºè®¾ç½®ç›®æ ‡çš„å±æ€§(è¿™äº›å±æ€§éƒ½éœ€ä¸æ·»åŠ ç›®æ ‡æ—¶ç›®æ ‡çš„ç±»å‹ä¸€ä¸€å¯¹åº”ï¼Œå¦åˆ™æ— æ•ˆï¼Œå±æ€§OUTPUT_NAMEæ˜¯é€šç”¨çš„),æŒ‡å®šç›¸å¯¹ç›®å½•æ˜¯ç›¸å¯¹äºè¿™ä¸ªç›®å½•<code>${CMAKE_BINARY_DIR}</code>ã€‚</p>
<ul>
<li>LIBRARY_OUTPUT_DIRECTORYï¼šè®¾ç½®å…±äº«åº“(.dll/.so)çš„è¾“å‡ºç›®å½•ã€‚</li>
<li>ARCHIVE_OUTPUT_DIRECTORYï¼šè®¾ç½®é™æ€åº“(.lib/.a)çš„è¾“å‡ºç›®å½•ã€‚</li>
<li>RUNTIME_OUTPUT_DIRECTORYï¼šè®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶(.exe)çš„è¾“å‡ºç›®å½•ã€‚</li>
<li>LIBRARY_OUTPUT_NAMEï¼šè®¾ç½®å…±äº«åº“(.dll/.so)å’Œé™æ€åº“çš„è¾“å‡ºåç§°ã€‚</li>
<li>RUNTIME_OUTPUT_NAMEï¼šè®¾ç½®å¯æ‰§è¡Œæ–‡ä»¶(.exe)çš„è¾“å‡ºåç§°ã€‚</li>
<li>OUTPUT_NAMEï¼šè®¾ç½®ä»»æ„ç›®æ ‡çš„è¾“å‡ºåç§°ã€‚</li>
<li>SUFFIXï¼šè¦†ç›–é»˜è®¤çš„åç¼€åã€‚</li>
</ul>
<h1 id="%e8%ae%be%e7%bd%ae%e7%9b%ae%e6%a0%87%e5%b1%9e%e6%80%a7-_3"></h1>
<p>ä¸‹ä¸€ç« <a href="#qtcmake">CMakeç»“åˆQt</a></p></section><section class="print-page" id="qtcmake"><h1 id="qtcmake-qt-cmake-examplestep6"><strong>Qt + CMake (example/step6)</strong></h1>
<p>æœ¬ç« ä¸»è¦ä»‹ç» <strong>Qt çš„ MOCã€RCCã€UIC</strong> åœ¨ CMake ä¸­çš„ä½¿ç”¨æ–¹å¼ã€‚</p>
<h3 id="qtcmake-1-rccqt"><strong>1. RCCï¼ˆQt èµ„æºç¼–è¯‘å™¨ï¼‰</strong></h3>
<p><a href="https://wiki.qt.io/QtResources">Qt èµ„æºç³»ç»Ÿ</a><br />
<code>rcc</code>ï¼ˆQt Resource Compilerï¼‰ç”¨äº <strong>å°†äºŒè¿›åˆ¶èµ„æºæ–‡ä»¶åµŒå…¥åˆ°åº”ç”¨ç¨‹åºä¸­</strong>ï¼Œæä¾›äº†ä¸€ç§è·¨å¹³å°çš„æ–¹æ³•æ¥è®¿é—®å›¾ç‰‡ã€éŸ³é¢‘ç­‰æ–‡ä»¶ã€‚<br />
<strong>æ ¸å¿ƒä½œç”¨</strong>ï¼š</p>
<ul>
<li>å°† <strong>.qrc</strong> æ–‡ä»¶è½¬æ¢ä¸º <strong>C++ ä»£ç </strong>ï¼Œç„¶ååµŒå…¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>å…è®¸ä½¿ç”¨ <code>":/path/to/resource"</code> ç›´æ¥è®¿é—®èµ„æºï¼Œè€Œä¸ä¾èµ–å¤–éƒ¨æ–‡ä»¶ã€‚</li>
</ul>
<h3 id="qtcmake-2-mocmeta-object-compiler"><strong>2. MOCï¼ˆMeta-Object Compilerï¼Œå…ƒå¯¹è±¡ç¼–è¯‘å™¨ï¼‰</strong></h3>
<p><a href="https://doc.qt.io/qt-6/moc.html">Qt å…ƒå¯¹è±¡ç¼–è¯‘å™¨</a><br />
<code>moc</code> ä¸»è¦ç”¨äº <strong>å¤„ç† Qt çš„å…ƒå¯¹è±¡ç³»ç»Ÿ</strong>ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>ä¿¡å·ä¸æ§½ï¼ˆsignals &amp; slotsï¼‰</strong></li>
<li><strong>åŠ¨æ€å±æ€§ï¼ˆDynamic Propertiesï¼‰</strong></li>
<li><strong>è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼ˆRTTIï¼‰</strong></li>
</ul>
<h3 id="qtcmake-3-uicui-compiler"><strong>3. UICï¼ˆUI Compilerï¼Œç”¨æˆ·ç•Œé¢ç¼–è¯‘å™¨ï¼‰</strong></h3>
<p><a href="https://doc.qt.io/qt-6/uic.html">Qt UIC </a><br />
<code>uic</code> ç”¨äº <strong>å°† .ui æ–‡ä»¶ï¼ˆQt Designer è®¾è®¡çš„ç•Œé¢ï¼‰è½¬æ¢ä¸º C++ ä»£ç </strong>ï¼Œå¹¶ç”Ÿæˆ <code>ui_*.h</code> å¤´æ–‡ä»¶ã€‚</p>
<h1 id="qtcmake-cmake">CMake ç¤ºä¾‹</h1>
<pre><code class="language-cmake">cmake_minimum_required(VERSION 3.20)

project(qt_cmake LANGUAGES CXX)

set(CMAKE_AUTOUIC ON)  # è‡ªåŠ¨å¤„ç† UI æ–‡ä»¶
set(CMAKE_AUTOMOC ON)  # è‡ªåŠ¨å¤„ç† Q_OBJECT ç›¸å…³ MOC ä»£ç 
set(CMAKE_AUTORCC ON)  # è‡ªåŠ¨å¤„ç† QRC èµ„æºæ–‡ä»¶

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

find_package(QT NAMES Qt6 Qt5 REQUIRED COMPONENTS Widgets)
find_package(Qt${QT_VERSION_MAJOR} REQUIRED COMPONENTS Widgets)

set(PROJECT_SOURCES
        main.cpp
        mainwindow.cpp
        mainwindow.h # å¤´æ–‡ä»¶ä¹Ÿæ˜¯å¿…è¦çš„
        mainwindow.ui # uiä¹Ÿèƒ½å¤„ç†
        resources.qrc  # æ·»åŠ  QRC èµ„æºæ–‡ä»¶
)

add_executable(untitled1
            ${PROJECT_SOURCES}
        )

target_link_libraries(untitled1 PRIVATE Qt${QT_VERSION_MAJOR}::Widgets)
</code></pre>
<pre><code class="language-cpp">// mainwindow.h
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include &lt;QMainWindow&gt;

QT_BEGIN_NAMESPACE

namespace Ui {
class MainWindow;
}

QT_END_NAMESPACE

class MainWindow : public QMainWindow {
    Q_OBJECT

public:
    MainWindow(QWidget *parent = nullptr);
    ~MainWindow();

private:
    Ui::MainWindow *ui;
};
#endif // MAINWINDOW_H
// &lt;&lt;mainwindow.h


// mainwindow.cpp
#include &quot;mainwindow.h&quot;
#include &quot;ajfioajifojaio/ui_mainwindow.h&quot;

MainWindow::MainWindow(QWidget *parent)
    : QMainWindow(parent),
      ui(new Ui::MainWindow) {
    ui-&gt;setupUi(this);
}

MainWindow::~MainWindow() {
    delete ui;
}
// &lt;&lt;mainwindow.cpp
</code></pre>
<h1 id="qtcmake-_1">è¿è¡Œ</h1>
<pre><code class="language-bash">rm build -rf &amp;&amp; 
cmake -S . -B build -G Ninja \
-DCMAKE_PREFIX_PATH=/home/awe/Qt/6.8.1/gcc_64 &amp;&amp;
cmake --build build -j 4
$ pwd 
&lt;CMAKE_BINARY_DIR&gt;/build/&lt;target&gt;_autogen/ # moc uic rcc ç­‰ç”Ÿæˆçš„æ–‡ä»¶
$ tree -L 3 .
..
â”œâ”€â”€ EWIEGA46WW
â”‚   â”œâ”€â”€ moc_mainwindow.cpp # ç”±mocç”Ÿæˆï¼Œæ ¹æ®mainwindow.hä¸­QOBJECTå®ç”Ÿæˆçš„mocå®ç°ä»£ç ï¼Œä¼šè¢«é“¾æ¥åˆ°target
â”‚   â””â”€â”€ moc_mainwindow.cpp.d # mainwindow.hçš„ä¾èµ–æ–‡ä»¶(.h) æ¯ä¸ª#include éƒ½ä¼šäº§ç”Ÿä¸€ç³»åˆ—ä¾èµ–
â”œâ”€â”€ include
â”‚   â””â”€â”€ ajfioajifojaio # ç”±uicç”Ÿæˆï¼Œæ ¹æ®åŒ¹é…è§„åˆ™(#include &quot;ajfioajifojaio/ui_mainwindow.h&quot;)ç”Ÿæˆçš„å¯¹åº”ui.h
â”‚       â””â”€â”€ ui_mainwindow.h

</code></pre>
<h2 id="qtcmake-_2">æ¡ˆä¾‹è®²è§£</h2>
<p><code>CMAKE_AUTOUIC</code>ã€ 
<code>CMAKE_AUTOMOC</code>ã€
<code>CMAKE_AUTORCC</code>
è¿™ä¸‰ä¸ª<code>CMAKE_&lt;cmake-property&gt;</code> 
å½±å“åé¢çš„æ¯ä¸€ä¸ªtarget(å¦‚add_executableã€add_libraryåˆ›å»ºçš„ç›®æ ‡)
ä¹Ÿå°±æ˜¯å…¨å±€å¼€å…³ï¼›</p>
<p>é™¤æ­¤ä¹‹å¤–ä¹Ÿæœ‰é’ˆå¯¹æ¯ä¸€ä¸ªtargetå•ç‹¬çš„å±æ€§(å¯ä»¥é€šè¿‡set_target_propertyè®¾ç½®)ï¼š
<a href="https://cmake.org/cmake/help/latest/prop_tgt/AUTOUIC.html">AUTOMOC</a> <a href="https://cmake.org/cmake/help/latest/prop_tgt/AUTOMOC.html">AUTOUIC</a> <a href="https://cmake.org/cmake/help/latest/prop_tgt/AUTORCC.html#prop_tgt:AUTORCC">AUTORCC</a>ä»–ä»¬éƒ½æ˜¯cmakeä¸­çš„ä¸€ä¸ª<a href="https://cmake.org/cmake/help/latest/manual/cmake-properties.7.html#id1">å±æ€§</a></p>
<blockquote>
<p>æ¯ä¸ªå¯¹è±¡å¯ä»¥é™„åŠ å±æ€§ï¼Œå±æ€§æ˜¯é™„åŠ åˆ°ç‰¹å®šå¯¹è±¡çš„é”®å€¼å¯¹</p>
</blockquote>
<h4 id="qtcmake-automoc">å±æ€§AUTOMOC:</h4>
<p>å†³å®šæ˜¯å¦æ£€æŸ¥ç›®æ ‡çš„c++æ–‡ä»¶(QOBJECTå®)æ˜¯å¦éœ€è¦moc,é»˜è®¤ä¸ä¼šé“¾æ¥.cppæ–‡ä»¶ç”Ÿæˆçš„mocæ–‡ä»¶,å¦‚æœéœ€è¦å¯ä»¥<code>#include &lt;base&gt;.moc"</code> å¦‚ï¼š<code>#include "main.moc</code> æ˜¯ä¸æ˜¯æœ‰çš„åœ°æ–¹è§è¿‡å‘¢ğŸ¤”<br>
å…¶å®å°±æ˜¯è‡ªåŠ¨æ‰«æmainwindow.hä¸­QOBJECTå®ï¼Œç”Ÿæˆmocå®ç°æ–‡ä»¶moc_mainwindow.cppï¼Œæ‰€ä»¥.hæ–‡ä»¶ä¹Ÿè¦add_executableã€‚</p>
<blockquote>
<p>æ­¤å¤–CLionã€Visual Studio éœ€è¦ <code>.h</code> æ–‡ä»¶ç”¨äºä»£ç åˆ†æï¼Œå› æ­¤éQté¡¹ç›®çš„ <code>.h</code> éœ€è¦åŠ å…¥ <code>add_executable()</code>ã€‚</p>
</blockquote>
<h4 id="qtcmake-autouic">å±æ€§AUTOUIC:</h4>
<p>å†³å®šæ˜¯å¦æ£€æŸ¥ç›®æ ‡ä¸­çš„ C++ æ–‡ä»¶ä»¥ç¡®å®šå®ƒä»¬æ˜¯å¦éœ€è¦è¿è¡Œ uicï¼Œå¹¶åˆ›å»ºè§„åˆ™ä»¥åœ¨é€‚å½“çš„æ—¶é—´æ‰§è¡Œ uicã€‚</p>
<blockquote>
<p>å®é™…å°±æ˜¯æ§åˆ¶<code>.ui</code> åˆ° <code>ui_*.h</code>çš„è½¬æ¢</p>
</blockquote>
<p><strong>uiæ–‡ä»¶æŸ¥æ‰¾è§„åˆ™ï¼š</strong></p>
<blockquote>
<p>cmakeä¼šæ‰¾åˆ°ä¸C++ä»£ç ä¸­åŒ¹é…<code>&lt;path/&gt;ui_&lt;basename&gt;.h</code>çš„ #include æŒ‡ä»¤ï¼Œå¦‚æœå­˜åœ¨ .ui æ–‡ä»¶ï¼Œåˆ™å°†æ‰§è¡Œ uic ä»¥ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶(å¦‚ä¸Šé¢çš„<code>ajfioajifojaio/ui_mainwindow.h</code>)ã€‚
.ui æœç´¢æ ¹æ®ä»¥ä¸‹åŒ¹é…è§„åˆ™:</p>
</blockquote>
<p><code>&lt;cmake_source_dir&gt;/&lt;basename&gt;.ui</code> </p>
<p><code>&lt;cmake_source_dir&gt;/&lt;path/&gt;&lt;basename&gt;.ui</code>  <strong>æ¨è</strong> </p>
<p><code>&lt;AUTOUIC_SEARCH_PATHS&gt;/&lt;basename&gt;.ui</code> </p>
<blockquote>
<p><strong>AUTOUIC_SEARCH_PATHS</strong>æ˜¯è‡ªå®šä¹‰çš„cmakeå˜é‡</p>
</blockquote>
<p><code>&lt;AUTOUIC_SEARCH_PATHS&gt;/&lt;path/&gt;&lt;basename&gt;.ui</code></p>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼šUI æ–‡ä»¶åº”ä¸ <code>.h/.cpp</code> ä¸€èµ·æ”¾ç½®ï¼š</p>
<pre><code class="language-bash">$ tree view/
view/
â”œâ”€â”€ mainwindow.cpp
â”œâ”€â”€ mainwindow.h
â””â”€â”€ mainwindow.ui
</code></pre>
<h4 id="qtcmake-autorcc">AUTORCC:</h4>
<p>å†³å®šæ˜¯å¦ <strong>è‡ªåŠ¨è¿è¡Œ <code>rcc</code></strong>ï¼Œå°† <code>.qrc</code> æ–‡ä»¶è½¬æ¢ä¸º C++ ä»£ç ã€‚
<strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="language-xml">&lt;RCC&gt;
    &lt;qresource prefix=&quot;/&quot;&gt;
        &lt;file&gt;icons/logo.png&lt;/file&gt;
        &lt;file&gt;myapp/main.qml&lt;/file&gt;
    &lt;/qresource&gt;
&lt;/RCC&gt;
</code></pre>
<p><strong>è®¿é—®æ–¹å¼ï¼š</strong></p>
<pre><code class="language-cpp">QPixmap pix(&quot;:/icons/logo.png&quot;); 

QQmlApplicationEngine engine;
//å¯¹äºè¦æ±‚QUrlçš„å‚æ•°ä½¿ç”¨&quot;qrc:/icons/logo.png&quot;
engine.load(QUrl(&quot;qrc:/myapp/main.qml&quot;));
</code></pre>
<p>é€šå¸¸ä¸å¿…åœ¨æ„(ä¾‹å¤–æ˜¯åŠ¨æ€åº“é™æ€åº“,å‚è§<a href="https://wiki.qt.io/QtResources">wiki</a>)ã€‚</p></section><section class="print-page" id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86"><h1 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_1">åŸºæœ¬å¸¸è¯†</h1>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_2">åŠ¨æ€åº“é“¾æ¥</h4>
<p>åœ¨ Windows ä¸Šï¼ŒåŠ¨æ€åº“ä½¿ç”¨ .dll åç¼€ï¼Œä½†ç¼–è¯‘å™¨æ— æ³•ç›´æ¥é“¾æ¥ .dll æ–‡ä»¶ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬é“¾æ¥ .dll å¯¹åº”çš„ .lib æ–‡ä»¶ï¼Œæä¾›ç¼–è¯‘æ—¶çš„åº“ä¿¡æ¯ã€‚
åœ¨ Linux ä¸Šï¼Œç›´æ¥é“¾æ¥.soæ—¢å¯ã€‚
è¿è¡Œæ—¶åŠ¨æ€åº“æœç´¢è·¯å¾„</p>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_3">è¿è¡Œæ—¶åŠ¨æ€åº“æœç´¢è·¯å¾„</h4>
<ul>
<li>Windowsï¼šåŠ¨æ€åº“å¿…é¡»ä½äºç³»ç»Ÿçš„æœç´¢è·¯å¾„ä¸­ã€‚ä¸€èˆ¬é€šè¿‡ç¯å¢ƒå˜é‡ PATH æŒ‡å®šï¼Œæˆ–è€…ç›´æ¥æ”¾åœ¨å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ç›®å½•ã€‚</li>
<li>Linuxï¼šè¿è¡Œæ—¶åŠ¨æ€åº“ä¸€èˆ¬é€šè¿‡ç¯å¢ƒå˜é‡ LD_LIBRARY_PATH æŸ¥æ‰¾ï¼Œç¡®ä¿åŠ¨æ€åº“åœ¨æ‰§è¡Œæ—¶å¯è¢«æ‰¾åˆ°ã€‚</li>
</ul>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_4">ç”Ÿæˆå™¨</h4>
<p>CMakeæ”¯æŒå¤šç§ç”Ÿæˆå™¨æ¥æ”¯æŒä¸åŒçš„æ„å»ºç³»ç»Ÿï¼Œé»˜è®¤çš„ç”Ÿæˆå™¨æ˜¯(cmake --help è¾“å‡ºä¸­å¸¦<code>*</code>æ ‡è®°çš„generator)
å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡CMAKE_GENERATORæ¥æ”¹å˜é»˜è®¤ç”Ÿæˆå™¨(CMake 3.15+ï¼‰)ã€‚</p>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_5">ç¼“å­˜å˜é‡</h4>
<p>CMake æ”¯æŒç¼“å­˜å˜é‡ï¼Œå®ƒä»¬å­˜å‚¨åœ¨<code>æ„å»ºç›®å½•</code>ä¸­çš„ <code>CMakeCache.txt</code> æ–‡ä»¶ä¸­ã€‚è°ƒç”¨ CMake æ—¶ä½¿ç”¨ -D å‚æ•°ä¼ é€’çš„å˜é‡ä¼šè‡ªåŠ¨ä½œä¸ºç¼“å­˜å˜é‡ä¿å­˜ã€‚<br />
ç¼“å­˜å˜é‡ä¸æ™®é€šå˜é‡çš„åŒºåˆ«:  </p>
<ul>
<li>æ™®é€šå˜é‡ï¼š
å®šä¹‰åœ¨ CMakeLists.txt ä¸­ï¼Œå…·æœ‰åŠ¨æ€ä½œç”¨åŸŸï¼Œä»…åœ¨å½“å‰ CMakeLists.txt æˆ–ä½œç”¨åŸŸä¸­æœ‰æ•ˆã€‚</li>
<li>ç¼“å­˜å˜é‡ï¼š
å…¨å±€å¯è§ï¼Œå­˜åœ¨äºæ•´ä¸ª CMake é…ç½®è¿‡ç¨‹ä¸­ï¼Œå³ä½¿ CMakeLists.txt çš„å˜é‡è¢«ä¿®æ”¹ï¼Œç¼“å­˜å˜é‡çš„å€¼ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œé™¤éå¼ºåˆ¶ä¿®æ”¹æˆ–æ¸…é™¤ç¼“å­˜ã€‚</li>
</ul>
<p>åˆ›å»ºç¼“å­˜å˜é‡çš„æ–¹å¼ï¼š  </p>
<ul>
<li>é€šè¿‡å‘½ä»¤è¡Œ -D å‚æ•°ï¼š<code>cmake -DCMAKE_BUILD_TYPE=Release</code></li>
<li>ä½¿ç”¨ option å‘½ä»¤åˆ›å»ºå¸ƒå°”ç¼“å­˜å˜é‡<code>option(ENABLE_FEATURE_A "feature_a" ON)</code></li>
<li>ä½¿ç”¨ set å‘½ä»¤æŒ‡å®šç¼“å­˜ç±»å‹ï¼š<code>set(VAR "value" CACHE STRING "æ³¨é‡Š")</code><blockquote>
<p>æ³¨æ„: ç¼“å­˜å˜é‡ä¿®æ”¹å¿…é¡»ä½¿ç”¨setçš„å¸¦<mark>FORCE</mark>ç‰ˆæœ¬set(VAR "value" CACHE STRING "æ³¨é‡Š" FORCE)</p>
</blockquote>
</li>
</ul>
<p>è¯»å–ç¼“å­˜å˜é‡ï¼š
    å¯èƒ½æ˜¯æ™®é€šå˜é‡ï¼Œ<code>${VAR}</code>ï¼Œæ¨è<code>$CACHE{VAR}</code></p>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmake">CMakeé…ç½®çš„å¤šç§æ–¹å¼</h4>
<ol>
<li>ä½¿ç”¨å½“å‰å·¥ä½œç›®å½•ä½œä¸ºæ„å»ºæ ‘ï¼Œä½¿ç”¨ <path-to-source> ä½œä¸ºæºä»£ç ç›®å½•ã€‚</li>
</ol>
<pre><code class="language-bash">cmake [options] &lt;path-to-source&gt; # ä¸æ¨è, cmake .
</code></pre>
<ol>
<li>ä½¿ç”¨ <path-to-existing-build> ä½œä¸ºæ„å»ºæ ‘ï¼Œå¹¶ä»å…¶ CMakeCache.txt æ–‡ä»¶åŠ è½½æºæ ‘çš„è·¯å¾„ã€‚</li>
</ol>
<pre><code class="language-bash">cmake [options] &lt;path-to-existing-build&gt; # åŠ è½½å·²ç»æ„å»ºäº†çš„ç¼“å­˜ï¼Œåˆ·æ–°CMakeListsçš„ä¿®æ”¹, cmake build/
</code></pre>
<ol>
<li>ä½¿ç”¨ <path-to-build> ä½œä¸ºæ„å»ºæ ‘ï¼Œä½¿ç”¨ <path-to-source> ä½œä¸ºæºæ ‘(æ¨è)ã€‚<blockquote>
<p>å¦‚æœä»…ç»™å‡ºä¸€ç§ç±»å‹çš„è·¯å¾„ï¼Œåˆ™å½“å‰å·¥ä½œç›®å½• (cwd) å°†ç”¨äºå¦ä¸€ç§è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p>
</blockquote>
</li>
</ol>
<pre><code class="language-bash">cmake [options] -S &lt;path-to-source&gt; -B &lt;path-to-build&gt; # æ— æ­§ä¹‰ï¼Œ cmake -S . -B build/
</code></pre>
<h3 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmake_1">CMakeæ ‡è¯†ç¬¦è§„åˆ™</h3>
<p>CMakeå‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™ã€‚ 
CMake ä¿ç•™ä»¥ä¸‹æ ‡è¯†ç¬¦ï¼ˆæ— è®ºæ˜¯å¤§å†™ã€å°å†™æˆ–æ··åˆå¤§å°å†™ï¼‰ï¼š</p>
<ul>
<li>begin with <code>CMAKE_</code></li>
<li>begin with<code>_CMAKE_</code></li>
<li>begin with <code>_</code></li>
</ul>
<h3 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmakeliststxt">CMakeLists.txt å†…æ–‡ä»¶è·¯å¾„çš„æŸ¥æ‰¾è§„åˆ™</h3>
<p>è·¯å¾„åˆ†éš”ç¬¦ç»Ÿä¸€ä»¥<code>/</code>åˆ†éš”ï¼Œcmakeä¼šè‡ªåŠ¨å¤„ç†ã€‚<code>\</code>éœ€è½¬ä¹‰ï¼Œå³<code>\\</code>ã€‚</p>
<ul>
<li><strong>ç»å¯¹è·¯å¾„</strong>ï¼šç›´æ¥æŒ‰ç…§æ–‡ä»¶ç³»ç»Ÿä¸­çš„å®é™…è·¯å¾„æŸ¥æ‰¾ï¼Œæ— éœ€ä¾èµ–å½“å‰ç›®å½•()ã€‚</li>
<li><strong>ç›¸å¯¹è·¯å¾„</strong>ï¼š  <ul>
<li><strong>ä¸€èˆ¬æƒ…å†µä¸‹</strong>ï¼šç›¸å¯¹è·¯å¾„æ˜¯ç›¸å¯¹äºå½“å‰ CMakeLists.txt æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚ä¾‹å¦‚ï¼Œ<code>add_executable()</code> æˆ– <code>add_library()</code> ç­‰å‘½ä»¤ä½¿ç”¨çš„æ–‡ä»¶è·¯å¾„ï¼Œéƒ½ä¼šä»¥å½“å‰ CMakeLists.txt çš„ç›®å½•ä½œä¸ºåŸºå‡†ã€‚  </li>
<li><strong>ç‰¹æ®Šæƒ…å†µ</strong>ï¼šå½“ä½¿ç”¨ <code>include(script.cmake)</code> æˆ– <code>find_package()</code> ç­‰å‘½ä»¤æ—¶ï¼Œè·¯å¾„ä¼šç›¸å¯¹äºè°ƒç”¨è¿™äº›å‘½ä»¤çš„ CMakeLists.txt æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œè€Œä¸æ˜¯è¢«åŒ…å«çš„è„šæœ¬æ–‡ä»¶ã€‚</li>
</ul>
</li>
</ul>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_6">ç¤ºä¾‹</h4>
<p>å‡è®¾ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="language-bash">project/
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ CMakeLists.txt
â”‚   â””â”€â”€ main.cpp
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ setup.cmake
</code></pre>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_7">ç¤ºä¾‹ä»£ç </h4>
<p><strong>é¡¶å±‚çš„CMakeLists.txt ä¸­çš„ç›¸å¯¹è·¯å¾„</strong>ï¼š</p>
<pre><code class="language-cmake">cmake_minimum_required(VERSION 3.20)
project(DemoProject)

add_subdirectory(src) # project/
include(scripts/setup.cmake) # project/
</code></pre>
<p><strong>src/CMakeLists.txt ä¸­çš„ç›¸å¯¹è·¯å¾„</strong>ï¼š  </p>
<pre><code class="language-cmake">add_executable(app main.cpp) # project/src/
</code></pre>
<p><strong><code>scripts/setup.cmake</code> æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„</strong>  </p>
<pre><code class="language-cmake">message(&quot;æ­£åœ¨å¤„ç†çš„cmakeæ–‡ä»¶è·¯å¾„ï¼š ${CMAKE_CURRENT_LIST_DIR}&quot;) # è¾“å‡º: project/scripts
message(&quot;å½“å‰æ‰€åœ¨çš„CMakeListsæ–‡ä»¶è·¯å¾„ï¼š ${CMAKE_CURRENT_SOURCE_DIR}&quot;) # è¾“å‡º: project
</code></pre>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmake_2">CMake å˜é‡ç»†åˆ™</h4>
<p>CMake çš„å˜é‡ç”¨æ¥å­˜å‚¨å€¼ï¼Œä½†æ‰€æœ‰å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚å³ä½¿çœ‹èµ·æ¥åƒæ•°å­—æˆ–å¸ƒå°”å€¼ï¼ŒCMake éƒ½ä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨å®ƒä»¬ã€‚</p>
<pre><code class="language-cmake">set(VAR1 &quot;Hello, World!&quot;)   # è®¾ç½®å˜é‡ VAR1 çš„å€¼ä¸ºå­—ç¬¦ä¸² &quot;Hello, World!&quot;
set(VAR2 42)                # è™½ç„¶çœ‹èµ·æ¥æ˜¯æ•°å­—ï¼Œä½† CMake å°† &quot;42&quot; å­˜å‚¨ä¸ºå­—ç¬¦ä¸²
set(VAR3 true)              # åŒæ ·ï¼Œ&quot;true&quot; ä¹Ÿæ˜¯å­—ç¬¦ä¸²
</code></pre>
<ol>
<li>å˜é‡å…·æœ‰åŠ¨æ€Block Scope(ä½œç”¨åŸŸ)ã€‚</li>
<li>æ¯ä¸ªå˜é‡â€œsetâ€æˆ–â€œunsetâ€éƒ½ä¼šåœ¨å½“å‰ä½œç”¨åŸŸä¸­åˆ›å»ºä¸€ä¸ªç»‘å®š,Block Scopeç»“æŸåˆ é™¤ç»‘å®šï¼Œæ¯æ¬¡åˆ›å»ºä½œç”¨åŸŸä¼šå¤åˆ¶çˆ¶ä½œç”¨åŸŸçš„å˜é‡ç»‘å®šã€‚è¿™æ„å‘³ç€å‡½æ•°å†…éƒ¨è®¾ç½®çš„å˜é‡ä¸ä¼šæ¸—é€åˆ°çˆ¶ä½œç”¨åŸŸä¸­ã€‚</li>
</ol>
<p>ä»¥ä¸‹å‘½ä»¤å¯ä»¥åˆ›å»ºæ–°çš„Block Scope:</p>
<ul>
<li>block()</li>
<li>function()</li>
<li>add_subdirectory()</li>
</ul>
<p><strong>setå‘½ä»¤è¯­æ³•ï¼š</strong></p>
<p><code>set(&lt;variable&gt; &lt;value&gt;... [PARENT_SCOPE])</code>
setä¹Ÿå¯ä»¥çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™é‡Œçš„<code>;</code>åˆ†å‰²ç¬¦ä¹Ÿèƒ½ä½¿ç”¨foreachéå†ã€‚listä¹Ÿæ˜¯å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="language-cmake">set(myVar a b c) # myVar = &quot;a;b;c&quot;
set(myVar a;b;c) # myVar = &quot;a;b;c&quot;
set(myVar &quot;a b c&quot;) # myVar = &quot;a b c&quot;
set(myVar a b;c) # myVar = &quot;a;b;c&quot;
set(myVar a &quot;b c&quot;) # myVar = &quot;a;b c&quot;
set(foo ab)# foo = &quot;ab&quot;
set(bar ${foo}cd)# bar= &quot;abcd&quot;
set(baz ${foo} cd)# baz= &quot;ab;cd&quot;
set(myVar ba)# myVar = &quot;ba&quot;
set(big &quot;${${myVar}r}ef&quot;) # big = &quot;${bar}ef&quot; = &quot;abcdef&quot;
set(${foo} xyz) # ab= &quot;xyz&quot;
set(bar ${notSetVar})# bar = &quot;&quot;

</code></pre>
<p>CMake set å‘½ä»¤æä¾›äº†ä¸€ä¸ªå…³äºä½œç”¨åŸŸçš„é€‰é¡¹ï¼ŒPARENT_SCOPE å°†å˜é‡è®¾ç½®åˆ°çˆ¶ä½œç”¨åŸŸä¸­ï¼Œè€Œä¸æ˜¯å½“å‰ä½œç”¨åŸŸä¸­ã€‚</p>
<p>å¦å¤–ï¼ŒCMakeç¼“å­˜å˜é‡æ˜¯å…·æœ‰å…¨å±€ä½œç”¨åŸŸçš„,é™¤éæŒ‡å®šäº†<code>FORCE</code>é€‰é¡¹ï¼Œå¦åˆ™<code>CACHE</code>é€‰é¡¹ä¸ä¼šè®¾ç½®<code>CACHE</code>ä¸­å·²å­˜åœ¨çš„å˜é‡ï¼Œå³<code>set(VAR "value" CACHE STRING "æ³¨é‡Š" FORCE)</code>ã€‚</p>
<p>ä¸å¤§å¤šç¼–ç¨‹è¯­è¨€ä¸åŒï¼ŒCMake çš„å¾ªç¯(if)å’Œæ§åˆ¶æµ(foreachã€while)æ²¡æœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚</p></section><section class="print-page" id="%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5"><h1 id="%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5-_1">å‚è€ƒæ–‡æ¡£</h1>
<p><a href="https://cliutils.gitlab.io/modern-cmake/README.html">https://cliutils.gitlab.io/modern-cmake/README.html</a><br />
<a href="https://cmake.org/cmake/help/v3.20/index.html">https://cmake.org/cmake/help/v3.20/index.html</a><br />
<a href="https://modern-cmake-cn.github.io/Modern-CMake-zh_CN/">https://modern-cmake-cn.github.io/Modern-CMake-zh_CN/</a><br />
<a href="https://xiazuomo.gitbook.io/modern-cmake-chinese/introduction">https://xiazuomo.gitbook.io/modern-cmake-chinese/introduction</a><br />
<a href="https://ukabuer.me/blog/more-modern-cmake/">https://ukabuer.me/blog/more-modern-cmake/</a><br />
<a href="https://www.bilibili.com/video/BV1Mw411M761/">https://www.bilibili.com/video/BV1Mw411M761/</a><br />
<a href="https://www.bilibili.com/video/BV16P4y1g7MH">https://www.bilibili.com/video/BV16P4y1g7MH</a><br />
<a href="https://crascit.com/professional-cmake/">https://crascit.com/professional-cmake/</a><br />
<a href="https://zh.wikipedia.org/wiki/CMake">https://zh.wikipedia.org/wiki/CMake</a><br />
<a href="https://github.com/Mq-b/CXX_LIB">https://github.com/Mq-b/CXX_LIB</a><br />
<a href="https://bazel.build/basics?hl=zh-cn">https://bazel.build/basics?hl=zh-cn</a>  </p></section><h1 class='nav-section-title-end'>Ended: ç« èŠ‚åˆ—è¡¨</h1>
                        <h1 class='nav-section-title' id='section-ç»å…¸æ¡ˆä¾‹'>
                            ç»å…¸æ¡ˆä¾‹ <a class='headerlink' href='#section-ç»å…¸æ¡ˆä¾‹' title='Permanent link'>â†µ</a>
                        </h1>
                        <section class="print-page" id="cmake%e5%88%b6%e4%bd%9c%e5%ba%93"><h1 id="cmake%e5%88%b6%e4%bd%9c%e5%ba%93-cmake">cmakeåˆ¶ä½œåº“</h1></section><h1 class='nav-section-title-end'>Ended: ç»å…¸æ¡ˆä¾‹</h1><section class="print-page" id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86"><h1 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_1">åŸºæœ¬å¸¸è¯†</h1>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_2">åŠ¨æ€åº“é“¾æ¥</h4>
<p>åœ¨ Windows ä¸Šï¼ŒåŠ¨æ€åº“ä½¿ç”¨ .dll åç¼€ï¼Œä½†ç¼–è¯‘å™¨æ— æ³•ç›´æ¥é“¾æ¥ .dll æ–‡ä»¶ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬é“¾æ¥ .dll å¯¹åº”çš„ .lib æ–‡ä»¶ï¼Œæä¾›ç¼–è¯‘æ—¶çš„åº“ä¿¡æ¯ã€‚
åœ¨ Linux ä¸Šï¼Œç›´æ¥é“¾æ¥.soæ—¢å¯ã€‚
è¿è¡Œæ—¶åŠ¨æ€åº“æœç´¢è·¯å¾„</p>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_3">è¿è¡Œæ—¶åŠ¨æ€åº“æœç´¢è·¯å¾„</h4>
<ul>
<li>Windowsï¼šåŠ¨æ€åº“å¿…é¡»ä½äºç³»ç»Ÿçš„æœç´¢è·¯å¾„ä¸­ã€‚ä¸€èˆ¬é€šè¿‡ç¯å¢ƒå˜é‡ PATH æŒ‡å®šï¼Œæˆ–è€…ç›´æ¥æ”¾åœ¨å¯æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ç›®å½•ã€‚</li>
<li>Linuxï¼šè¿è¡Œæ—¶åŠ¨æ€åº“ä¸€èˆ¬é€šè¿‡ç¯å¢ƒå˜é‡ LD_LIBRARY_PATH æŸ¥æ‰¾ï¼Œç¡®ä¿åŠ¨æ€åº“åœ¨æ‰§è¡Œæ—¶å¯è¢«æ‰¾åˆ°ã€‚</li>
</ul>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_4">ç”Ÿæˆå™¨</h4>
<p>CMakeæ”¯æŒå¤šç§ç”Ÿæˆå™¨æ¥æ”¯æŒä¸åŒçš„æ„å»ºç³»ç»Ÿï¼Œé»˜è®¤çš„ç”Ÿæˆå™¨æ˜¯(cmake --help è¾“å‡ºä¸­å¸¦<code>*</code>æ ‡è®°çš„generator)
å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡CMAKE_GENERATORæ¥æ”¹å˜é»˜è®¤ç”Ÿæˆå™¨(CMake 3.15+ï¼‰)ã€‚</p>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_5">ç¼“å­˜å˜é‡</h4>
<p>CMake æ”¯æŒç¼“å­˜å˜é‡ï¼Œå®ƒä»¬å­˜å‚¨åœ¨<code>æ„å»ºç›®å½•</code>ä¸­çš„ <code>CMakeCache.txt</code> æ–‡ä»¶ä¸­ã€‚è°ƒç”¨ CMake æ—¶ä½¿ç”¨ -D å‚æ•°ä¼ é€’çš„å˜é‡ä¼šè‡ªåŠ¨ä½œä¸ºç¼“å­˜å˜é‡ä¿å­˜ã€‚<br />
ç¼“å­˜å˜é‡ä¸æ™®é€šå˜é‡çš„åŒºåˆ«:  </p>
<ul>
<li>æ™®é€šå˜é‡ï¼š
å®šä¹‰åœ¨ CMakeLists.txt ä¸­ï¼Œå…·æœ‰åŠ¨æ€ä½œç”¨åŸŸï¼Œä»…åœ¨å½“å‰ CMakeLists.txt æˆ–ä½œç”¨åŸŸä¸­æœ‰æ•ˆã€‚</li>
<li>ç¼“å­˜å˜é‡ï¼š
å…¨å±€å¯è§ï¼Œå­˜åœ¨äºæ•´ä¸ª CMake é…ç½®è¿‡ç¨‹ä¸­ï¼Œå³ä½¿ CMakeLists.txt çš„å˜é‡è¢«ä¿®æ”¹ï¼Œç¼“å­˜å˜é‡çš„å€¼ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œé™¤éå¼ºåˆ¶ä¿®æ”¹æˆ–æ¸…é™¤ç¼“å­˜ã€‚</li>
</ul>
<p>åˆ›å»ºç¼“å­˜å˜é‡çš„æ–¹å¼ï¼š  </p>
<ul>
<li>é€šè¿‡å‘½ä»¤è¡Œ -D å‚æ•°ï¼š<code>cmake -DCMAKE_BUILD_TYPE=Release</code></li>
<li>ä½¿ç”¨ option å‘½ä»¤åˆ›å»ºå¸ƒå°”ç¼“å­˜å˜é‡<code>option(ENABLE_FEATURE_A "feature_a" ON)</code></li>
<li>ä½¿ç”¨ set å‘½ä»¤æŒ‡å®šç¼“å­˜ç±»å‹ï¼š<code>set(VAR "value" CACHE STRING "æ³¨é‡Š")</code><blockquote>
<p>æ³¨æ„: ç¼“å­˜å˜é‡ä¿®æ”¹å¿…é¡»ä½¿ç”¨setçš„å¸¦<mark>FORCE</mark>ç‰ˆæœ¬set(VAR "value" CACHE STRING "æ³¨é‡Š" FORCE)</p>
</blockquote>
</li>
</ul>
<p>è¯»å–ç¼“å­˜å˜é‡ï¼š
    å¯èƒ½æ˜¯æ™®é€šå˜é‡ï¼Œ<code>${VAR}</code>ï¼Œæ¨è<code>$CACHE{VAR}</code></p>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmake">CMakeé…ç½®çš„å¤šç§æ–¹å¼</h4>
<ol>
<li>ä½¿ç”¨å½“å‰å·¥ä½œç›®å½•ä½œä¸ºæ„å»ºæ ‘ï¼Œä½¿ç”¨ <path-to-source> ä½œä¸ºæºä»£ç ç›®å½•ã€‚</li>
</ol>
<pre><code class="language-bash">cmake [options] &lt;path-to-source&gt; # ä¸æ¨è, cmake .
</code></pre>
<ol>
<li>ä½¿ç”¨ <path-to-existing-build> ä½œä¸ºæ„å»ºæ ‘ï¼Œå¹¶ä»å…¶ CMakeCache.txt æ–‡ä»¶åŠ è½½æºæ ‘çš„è·¯å¾„ã€‚</li>
</ol>
<pre><code class="language-bash">cmake [options] &lt;path-to-existing-build&gt; # åŠ è½½å·²ç»æ„å»ºäº†çš„ç¼“å­˜ï¼Œåˆ·æ–°CMakeListsçš„ä¿®æ”¹, cmake build/
</code></pre>
<ol>
<li>ä½¿ç”¨ <path-to-build> ä½œä¸ºæ„å»ºæ ‘ï¼Œä½¿ç”¨ <path-to-source> ä½œä¸ºæºæ ‘(æ¨è)ã€‚<blockquote>
<p>å¦‚æœä»…ç»™å‡ºä¸€ç§ç±»å‹çš„è·¯å¾„ï¼Œåˆ™å½“å‰å·¥ä½œç›®å½• (cwd) å°†ç”¨äºå¦ä¸€ç§è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p>
</blockquote>
</li>
</ol>
<pre><code class="language-bash">cmake [options] -S &lt;path-to-source&gt; -B &lt;path-to-build&gt; # æ— æ­§ä¹‰ï¼Œ cmake -S . -B build/
</code></pre>
<h3 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmake_1">CMakeæ ‡è¯†ç¬¦è§„åˆ™</h3>
<p>CMakeå‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™ã€‚ 
CMake ä¿ç•™ä»¥ä¸‹æ ‡è¯†ç¬¦ï¼ˆæ— è®ºæ˜¯å¤§å†™ã€å°å†™æˆ–æ··åˆå¤§å°å†™ï¼‰ï¼š</p>
<ul>
<li>begin with <code>CMAKE_</code></li>
<li>begin with<code>_CMAKE_</code></li>
<li>begin with <code>_</code></li>
</ul>
<h3 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmakeliststxt">CMakeLists.txt å†…æ–‡ä»¶è·¯å¾„çš„æŸ¥æ‰¾è§„åˆ™</h3>
<p>è·¯å¾„åˆ†éš”ç¬¦ç»Ÿä¸€ä»¥<code>/</code>åˆ†éš”ï¼Œcmakeä¼šè‡ªåŠ¨å¤„ç†ã€‚<code>\</code>éœ€è½¬ä¹‰ï¼Œå³<code>\\</code>ã€‚</p>
<ul>
<li><strong>ç»å¯¹è·¯å¾„</strong>ï¼šç›´æ¥æŒ‰ç…§æ–‡ä»¶ç³»ç»Ÿä¸­çš„å®é™…è·¯å¾„æŸ¥æ‰¾ï¼Œæ— éœ€ä¾èµ–å½“å‰ç›®å½•()ã€‚</li>
<li><strong>ç›¸å¯¹è·¯å¾„</strong>ï¼š  <ul>
<li><strong>ä¸€èˆ¬æƒ…å†µä¸‹</strong>ï¼šç›¸å¯¹è·¯å¾„æ˜¯ç›¸å¯¹äºå½“å‰ CMakeLists.txt æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ã€‚ä¾‹å¦‚ï¼Œ<code>add_executable()</code> æˆ– <code>add_library()</code> ç­‰å‘½ä»¤ä½¿ç”¨çš„æ–‡ä»¶è·¯å¾„ï¼Œéƒ½ä¼šä»¥å½“å‰ CMakeLists.txt çš„ç›®å½•ä½œä¸ºåŸºå‡†ã€‚  </li>
<li><strong>ç‰¹æ®Šæƒ…å†µ</strong>ï¼šå½“ä½¿ç”¨ <code>include(script.cmake)</code> æˆ– <code>find_package()</code> ç­‰å‘½ä»¤æ—¶ï¼Œè·¯å¾„ä¼šç›¸å¯¹äºè°ƒç”¨è¿™äº›å‘½ä»¤çš„ CMakeLists.txt æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œè€Œä¸æ˜¯è¢«åŒ…å«çš„è„šæœ¬æ–‡ä»¶ã€‚</li>
</ul>
</li>
</ul>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_6">ç¤ºä¾‹</h4>
<p>å‡è®¾ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="language-bash">project/
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ CMakeLists.txt
â”‚   â””â”€â”€ main.cpp
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ setup.cmake
</code></pre>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-_7">ç¤ºä¾‹ä»£ç </h4>
<p><strong>é¡¶å±‚çš„CMakeLists.txt ä¸­çš„ç›¸å¯¹è·¯å¾„</strong>ï¼š</p>
<pre><code class="language-cmake">cmake_minimum_required(VERSION 3.20)
project(DemoProject)

add_subdirectory(src) # project/
include(scripts/setup.cmake) # project/
</code></pre>
<p><strong>src/CMakeLists.txt ä¸­çš„ç›¸å¯¹è·¯å¾„</strong>ï¼š  </p>
<pre><code class="language-cmake">add_executable(app main.cpp) # project/src/
</code></pre>
<p><strong><code>scripts/setup.cmake</code> æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„</strong>  </p>
<pre><code class="language-cmake">message(&quot;æ­£åœ¨å¤„ç†çš„cmakeæ–‡ä»¶è·¯å¾„ï¼š ${CMAKE_CURRENT_LIST_DIR}&quot;) # è¾“å‡º: project/scripts
message(&quot;å½“å‰æ‰€åœ¨çš„CMakeListsæ–‡ä»¶è·¯å¾„ï¼š ${CMAKE_CURRENT_SOURCE_DIR}&quot;) # è¾“å‡º: project
</code></pre>
<h4 id="%e5%9f%ba%e6%9c%ac%e5%b8%b8%e8%af%86-cmake_2">CMake å˜é‡ç»†åˆ™</h4>
<p>CMake çš„å˜é‡ç”¨æ¥å­˜å‚¨å€¼ï¼Œä½†æ‰€æœ‰å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚å³ä½¿çœ‹èµ·æ¥åƒæ•°å­—æˆ–å¸ƒå°”å€¼ï¼ŒCMake éƒ½ä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼å­˜å‚¨å®ƒä»¬ã€‚</p>
<pre><code class="language-cmake">set(VAR1 &quot;Hello, World!&quot;)   # è®¾ç½®å˜é‡ VAR1 çš„å€¼ä¸ºå­—ç¬¦ä¸² &quot;Hello, World!&quot;
set(VAR2 42)                # è™½ç„¶çœ‹èµ·æ¥æ˜¯æ•°å­—ï¼Œä½† CMake å°† &quot;42&quot; å­˜å‚¨ä¸ºå­—ç¬¦ä¸²
set(VAR3 true)              # åŒæ ·ï¼Œ&quot;true&quot; ä¹Ÿæ˜¯å­—ç¬¦ä¸²
</code></pre>
<ol>
<li>å˜é‡å…·æœ‰åŠ¨æ€Block Scope(ä½œç”¨åŸŸ)ã€‚</li>
<li>æ¯ä¸ªå˜é‡â€œsetâ€æˆ–â€œunsetâ€éƒ½ä¼šåœ¨å½“å‰ä½œç”¨åŸŸä¸­åˆ›å»ºä¸€ä¸ªç»‘å®š,Block Scopeç»“æŸåˆ é™¤ç»‘å®šï¼Œæ¯æ¬¡åˆ›å»ºä½œç”¨åŸŸä¼šå¤åˆ¶çˆ¶ä½œç”¨åŸŸçš„å˜é‡ç»‘å®šã€‚è¿™æ„å‘³ç€å‡½æ•°å†…éƒ¨è®¾ç½®çš„å˜é‡ä¸ä¼šæ¸—é€åˆ°çˆ¶ä½œç”¨åŸŸä¸­ã€‚</li>
</ol>
<p>ä»¥ä¸‹å‘½ä»¤å¯ä»¥åˆ›å»ºæ–°çš„Block Scope:</p>
<ul>
<li>block()</li>
<li>function()</li>
<li>add_subdirectory()</li>
</ul>
<p><strong>setå‘½ä»¤è¯­æ³•ï¼š</strong></p>
<p><code>set(&lt;variable&gt; &lt;value&gt;... [PARENT_SCOPE])</code>
setä¹Ÿå¯ä»¥çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™é‡Œçš„<code>;</code>åˆ†å‰²ç¬¦ä¹Ÿèƒ½ä½¿ç”¨foreachéå†ã€‚listä¹Ÿæ˜¯å­—ç¬¦ä¸²ã€‚</p>
<pre><code class="language-cmake">set(myVar a b c) # myVar = &quot;a;b;c&quot;
set(myVar a;b;c) # myVar = &quot;a;b;c&quot;
set(myVar &quot;a b c&quot;) # myVar = &quot;a b c&quot;
set(myVar a b;c) # myVar = &quot;a;b;c&quot;
set(myVar a &quot;b c&quot;) # myVar = &quot;a;b c&quot;
set(foo ab)# foo = &quot;ab&quot;
set(bar ${foo}cd)# bar= &quot;abcd&quot;
set(baz ${foo} cd)# baz= &quot;ab;cd&quot;
set(myVar ba)# myVar = &quot;ba&quot;
set(big &quot;${${myVar}r}ef&quot;) # big = &quot;${bar}ef&quot; = &quot;abcdef&quot;
set(${foo} xyz) # ab= &quot;xyz&quot;
set(bar ${notSetVar})# bar = &quot;&quot;

</code></pre>
<p>CMake set å‘½ä»¤æä¾›äº†ä¸€ä¸ªå…³äºä½œç”¨åŸŸçš„é€‰é¡¹ï¼ŒPARENT_SCOPE å°†å˜é‡è®¾ç½®åˆ°çˆ¶ä½œç”¨åŸŸä¸­ï¼Œè€Œä¸æ˜¯å½“å‰ä½œç”¨åŸŸä¸­ã€‚</p>
<p>å¦å¤–ï¼ŒCMakeç¼“å­˜å˜é‡æ˜¯å…·æœ‰å…¨å±€ä½œç”¨åŸŸçš„,é™¤éæŒ‡å®šäº†<code>FORCE</code>é€‰é¡¹ï¼Œå¦åˆ™<code>CACHE</code>é€‰é¡¹ä¸ä¼šè®¾ç½®<code>CACHE</code>ä¸­å·²å­˜åœ¨çš„å˜é‡ï¼Œå³<code>set(VAR "value" CACHE STRING "æ³¨é‡Š" FORCE)</code>ã€‚</p>
<p>ä¸å¤§å¤šç¼–ç¨‹è¯­è¨€ä¸åŒï¼ŒCMake çš„å¾ªç¯(if)å’Œæ§åˆ¶æµ(foreachã€while)æ²¡æœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚</p></section><section class="print-page" id="about"><h1 id="about-hello-about">hello about</h1></section></div></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "/",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../js/print-site.js"></script>
        <script src="../extra.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
